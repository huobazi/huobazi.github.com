
    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">

    <link rel="stylesheet" href='https://huobazi.github.com/css/all.min.css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="武眉博" href='https://huobazi.github.com/index.xml' />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="https://huobazi.github.com">武眉博</a></h1>
            <h2 class="brand-tagline"> Marble&#39;s blog </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="https://twitter.com/huobazi">
                        <i class="fa fa-twitter"></i> Twitter
                    </a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/huobazi">
                        <i class="fa fa-github-alt"></i> Github
                    </a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://www.linkedin.com/in/huobazi">
                        <i class="fa fa-linkedin"></i> LinkedIn
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href='https://huobazi.github.com/index.xml'>
                        <i class="fa fa-rss"></i> rss
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">07 Sep 2007</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2007/09/07/cb-885304/" class="post-title">一系列SQL SERVER SQL 的分析文章</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-闲言碎语" href='/tags/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD'>闲言碎语</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-SQL Server" href='/tags/sql-server'>SQL Server</a>
                                
                                    <a class="post-category post-category-.Net其他" href='/tags/.net%E5%85%B6%E4%BB%96'>.Net其他</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><br /><br />位于：<br /><br /><a href="http://blogs.sqlpassj.org/mitsugi/archive/2007/09.aspx">http://blogs.sqlpassj.org/mitsugi/archive/2007/09.aspx</a><br /><br />语言： 日文<br /><br />
<a id="ArchiveMonth.ascx_Days_Entries__ctl0_TitleUrl" href="http://blogs.sqlpassj.org/mitsugi/archive/2007/09/05/23974.aspx">[SQL Server 2005]AGGREGATES/インデックス付きビュー/DTA デモ</a>
<br /><br />
<a id="ArchiveMonth.ascx_Days_Entries__ctl1_TitleUrl" href="http://blogs.sqlpassj.org/mitsugi/archive/2007/09/05/23973.aspx">[SQL Server 2005]JOIN デモ</a>
<br /><br />
<a id="ArchiveMonth.ascx_Days_Entries__ctl2_TitleUrl" href="http://blogs.sqlpassj.org/mitsugi/archive/2007/09/05/23972.aspx">[SQL Server]OR デモ</a>
<br /><br />
<a id="ArchiveMonth.ascx_Days_Entries__ctl3_TitleUrl" href="http://blogs.sqlpassj.org/mitsugi/archive/2007/09/02/23963.aspx">[SQL Server]AND デモ</a>
<br /><br />
<a id="ArchiveMonth.ascx_Days_Entries__ctl4_TitleUrl" href="http://blogs.sqlpassj.org/mitsugi/archive/2007/09/02/23962.aspx">[SQL Server]検索性デモ</a>
<br /><br /></p>

                    </div>
                </section>
                
                <h1 class="content-subhead">12 Dec 2005</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2005/12/12/freeaspdotnetsqlserverexpresswebhosting/" class="post-title">免费的Asp.net2.0 Sqlserver express的学习空间</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-SQL Server" href='/tags/sql-server'>SQL Server</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><p></p>
<p><b><font face="Tahoma" color="black"> <font color="#0000ff">dotnetspider.com</font>提供Asp.net2.0 Sqlserver express的学习空间<br /><br /><font color="#ff0000">- Learn ASP.NET 2.0</font></font><font color="#ff0000"> <br /><font face="Tahoma">- Develop your web site</font> <br /><font face="Tahoma">- Host it for free.</font> </font></b></p>
<b><br /></b><p><font color="#ff0000"><font face="Tahoma" color="#000000">Web hosting package <br />For ASP.NET programmers</font><font face="Tahoma"> </font></font></p>
<li>
<font color="#ff0000">$0.00 monthly fee. </font><br />
</li>
<li>
<font color="#ff0000">No advertisements in your site. </font><br />
</li>
<li>
<font color="#ff0000">SQL Server Express support. </font><br />
</li>
<li>
<font color="#ff0000">MS Access support. </font><br />
</li>
<li>
<font color="#ff0000">Up to 100 MB Space. </font><br />
</li>
<li>
<font color="#ff0000">2 GB monthly data transfer. </font><br />
</li>
<li>
<font color="#ff0000">Your own </font><font color="#ff0000">domain name</font><font color="#ff0000">.</font><font color="#000000"> </font> <br /><p>详细描述参考下面的页面：<br /><a href="http://www.github.com/private/5271/default.aspx" target="_blank"><font face="Tahoma" color="#0000ff" size="4"><a href="http://www.github.com/private/5271/default.aspx">http://www.github.com/private/5271/default.aspx</a></font></a></p>
</li></p>

                    </div>
                </section>
                
                <h1 class="content-subhead">10 Oct 2005</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2005/10/10/cb-251251/" class="post-title">哭使用Data Access 2 插入Ntext类型数据时SqlParameter不指定类型的问题 ， ，请为我解惑</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-SQL Server" href='/tags/sql-server'>SQL Server</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>实在郁闷 <img height="19" src="/images/hbz_images/0a603e93-b2ed-47bf-86c0-ebbf83a0f832.png3" width="19" border="0">，请大家为我解惑。<br />同发csdn：<a href="http://community.csdn.net/Expert/topic/4315/4315539.xml?temp=.3931848">http://community.csdn.net/Expert/topic/4315/4315539.xml?temp=.3931848</a><br /><br />原来的代码 <br /></p>
<p></p>
<div class="codeDiv"> SqlHelper.ExecuteNonQuery(connectionString, CommandType.StoredProcedure, <br />  FullyQualifiedSprocName("P_InsertNtextData"), <br />  new SqlParameter("@Id", f.Id),<br />  new SqlParameter("@NtextData",f.Data));<br />
</div>
<p>如果 f.Data过长，就莫名其妙的异常， <br /></p>
<p></p>
<div class="codeDiv">
<p>---------------------------</p>
<br /><p>---------------------------<br />当前命令发生了严重错误。应放弃任何可能产生的结果。<br />---------------------------<br />确定   <br />---------------------------</p>
<br /><p>---------------------------</p>
<br /><p>---------------------------<br />常规网络错误。请检查您的网络文档。<br />---------------------------<br />确定   <br />---------------------------<br /></p>
</div>
<p>Google baidu 都翻了个底朝天，也没个能安慰我的信息。<br />试验了一下午，最后试出来写个测试字符串"aaaa"就能插入<br />尝试了如下代码 <br /></p>
<p></p>
<div class="codeDiv"> SqlParameter ntext = new SqlParameter("@NtextData",SqlDbType.NText);<br /> ntext.Value = f.Data;<br /> SqlHelper.ExecuteNonQuery(connectionString, CommandType.StoredProcedure, <br />  FullyQualifiedSprocName("P_InsertNtextData"), <br />  new SqlParameter("@Id", f.Id),<br />  ntext);<br />
</div>
<p></p>
<p>成功，怎么也想不通这换汤不换药的方法为何能够成功，<br />翻msdn，<br />打自己一巴掌<img height="19" src="/images/hbz_images/0a603e93-b2ed-47bf-86c0-ebbf83a0f832.png4" width="19" border="0"><img height="20" src="/images/hbz_images/0a603e93-b2ed-47bf-86c0-ebbf83a0f832.png5" width="25" border="0"><br /></p>
<p></p>
<div class="codeDiv">获取或设置参数的 SqlDbType。 <br /><p></p>
<br /><p>[Visual Basic]<br />Public Property SqlDbType As SqlDbType</p>
<br /><p>[C#]<br />public SqlDbType SqlDbType {get; set;}</p>
<br /><p><br />属性值<br />SqlDbType 值之一。默认值为 <font color="#0000ff">NVarChar</font>。 </p>
</div>
<p></p>
<p>然而我又看到另外一个构造器的重载这样说明<br /></p>
<p></p>
<div class="codeDiv">[Visual Basic]<br />Public Sub New( _<br />   ByVal parameterName As String, _<br />   ByVal value As Object _<br />) <br /><p></p>
<br /><p>[C#]<br />public SqlParameter(<br />   string parameterName,<br />   object value<br />);</p>
<br /><p><br />参数<br />parameterName <br />要映射的参数的名称。 <br />value <br />一个 Object，它是 SqlParameter 的值。 <br />备注<br /><font color="#0000ff">当在 value 参数中指定 Object 时，SqlDbType 将从 Object 的 .NET Framework 类型推断出。</font></p>
</div>
<p></p>
<p>这又如何解释？？</p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">14 Jul 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/07/14/cb-24010/" class="post-title">数据从SqlServer6.5到SqlServer2000</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-SQL Server" href='/tags/sql-server'>SQL Server</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p></p>
<p></p>
<div style="FONT-SIZE: 13px">一台SqlServer65上的数据需要导到SqlServer200下<br />源机器:WinNt4 sp6 SqlServer65 Sp5a<br />目的机器: Win2000 sp4 SqlServer2000 sp3a<br />导入的过程非常艰辛,必尽这两个产品版本相距太远了.<br />微软动力营的专家Mingqing Cheng给予了很多帮助,在此表示由衷的感谢!<br />以下摘自微软动力营<br /><textarea style="WIDTH: 558px; HEIGHT: 88px" rows="4" cols="60">活靶子，您好 根据您的描述，我对您问题的理解是您希望将原来SQL Server 6.5 上的数据升级到SQL Server 2000上。不知道我理解的正确吗？ 根据我的经验，在升级之前您需要首先将SQL Server 6.5升级到下列版本 SQL Server 6.5 Post Service Pack 5a Update (Intel) http://www.microsoft.com/downloads/details.aspx?FamilyID=6bf98310-4fea-405f-9ee0-c1e22580776b&amp;DisplayLang=en 然后您准备升级的SQL Server 6.5是否和SQL Server 2000安装在同一台服务器上呢？在升级的过程中您需要从SQL Server 2000的SQL Server Upgrade Wizard来进行升级。 在下面的这篇文档中罗列了三点在升级中可能要考虑的地方，以及可能的影响 How To Upgrade from SQL Server 6.5 http://msdn.microsoft.com/library/default.asp?url=/library/en-us/howtosql/ht_install_48l5.asp 具体的升级要求和标准，您可以参照下列白皮书 How to Upgrade SQL Server 6.5 and 7.0 to SQL Server 2000 http://www.microsoft.com/technet/prodtechnol/sql/2000/deploy/sqlugrd.mspx 最后，您可以从这里找到一些常见的在升级到SQL Server 2000时可能遇到的问题 INF: Frequently Asked Questions - SQL Server 2000 - Upgrade http://support.microsoft.com/default.aspx?scid=kb;en-us;261334 在这篇文章中，我愿意向您重点推荐的针对问题8的回答：对于SQL Server 6.5的大小可能对升级时间带来的影响 希望我回答并且解决了您的问题，而且所附上的这些信息对您有所帮助！如有任何疑问或需要进一步帮助，请您直接在新闻组里发贴，我们非常乐意帮助您解决问题！ 希望您能满意我的支持服务！感谢您选择微软产品并使用微软动力营合作伙伴新闻组技术支持！ Mingqing Cheng [微软] 微软全球技术中心 微软动力营合作伙伴技术支持 ----------------------------------------------- 使您100%满意是"微软动力s营"合作伙伴支持服务的唯一目标。我们真诚希望您能够对"微软动力营"服务提出宝贵建议和意见，我们将针对您的反馈不断改进服务质量。如有任何问题，请发信至：cmsdn@microsoft.com </textarea><br /><br /><textarea style="WIDTH: 558px; HEIGHT: 88px" rows="4" cols="60">您好, 能麻烦您具体和我说一下您采用什么方式升级的吗?在SQL Server Upgrade Wizard选择的时候，您是否选择了Object and Data呢？您升级的时候，最好能够直接升级到SQL Server默认的Instance。您是否已经将SQL Server 6.5和SQL server 2000分别升级到Service Pack 5a和Service Pack 3a呢？ 您在升级的过程中有没有遇到什么错误的信息呢？您对于该过程越详细地描述就能有助于我们越快越准确地找到问题的所在。 下面我将SQL Server Books Online上有关如何从SQL Server 6.5升级到SQL Server 2000的需要注意的事项粘贴在下面 =================================== 从 SQL Server 6.5 升级时的注意事项： 在升级过程中，SQL Server 6.5 服务器将停止并启动，同时将对象编为脚本并析取数据。数据传输开始后，只有 SQL Server 2000 在运行，无法访问 SQL Server 6.5。 如果将现有的 SQL Server 6.5 服务器升级到运行 SQL Server 2000 的另一台计算机，则这两台计算机都应配置为对 MSSQLServer 服务使用域用户名和密码。 在该升级过程中，在 SQL Server 6.5 中使用 sp_addmessage 创建的用户定义消息不转换到 SQL Server 2000。若要保留这些自定义消息，请将在 SQL Server 6.5 中添加的消息手工复制到 SQL Server 2000 安装。 =================================== 下面的这篇联机手册中的文档详细介绍了如何使用SQL Server Upgrade Wizard来升级的步骤 “如何使用直接管道将 SQL Server 6.5 版升级到 SQL Server 2000（SQL Server 升级向导）” 希望您能满意我的支持服务！感谢您选择微软产品并使用微软动力营合作伙伴新闻组技术支持！ Mingqing Cheng [微软] 微软全球技术中心 微软动力营合作伙伴技术支持 ----------------------------------------------- 使您100%满意是"微软动力s营"合作伙伴支持服务的唯一目标。我们真诚希望您能够对"微软动力营"服务提出宝贵建议和意见，我们将针对您的反馈不断改进服务质量。如有任何问题，请发信至：cmsdn@microsoft.com 本贴子以“现状”提供且没有任何担保，同时也没有授予任何权利。</textarea><br /><br /><textarea style="WIDTH: 558px; HEIGHT: 88px" rows="4" cols="60">您好， 不知道您的问题解决了吗？我给您的那些建议是否有用呢？ 您能够成功地从SQL Server 6.5中将数据导入SQL Server 2000，而不是只有表的结构了吗？ 如果您在导入的过程中遇到问题，您可以继续在这个贴字后面提问或者发新的帖子提问。我会很愿意在这方面尽我的所能来帮助您：） 希望您能满意我的支持服务！感谢您选择微软产品并使用微软动力营合作伙伴新闻组技术支持！ Mingqing Cheng [微软] 微软全球技术中心 微软动力营合作伙伴技术支持 ----------------------------------------------- 使您100%满意是"微软动力s营"合作伙伴支持服务的唯一目标。我们真诚希望您能够对"微软动力营"服务提出宝贵建议和意见，我们将针对您的反馈不断改进服务质量。如有任何问题，请发信至：cmsdn@microsoft.com 本贴子以“现状”提供且没有任何担保，同时也没有授予任何权利。 </textarea><br />我们在升级过程中发现很难将SQL65升级通过"一切版本切换"升级过来,期间碰到了很多错误,<br />也不知道是什么原因.这里就不在罗列了.<br />又尝试了好多方法,后来,我们采用如下步骤达到了目的!<br /><br /><div style="FONT-SIZE: 13px; COLOR: blue; BACKGROUND-COLOR: beige">1,在Sql65中选择生成Sql脚本,对于所有的过程,视图,表,用户,等信息生成Sql脚本.<br />该脚本无法在Sql2000下直接运行,我们发现Sql65所生成的脚本中对于字符串均用""括起来的,在文<br />本编辑器中采用批量替换"为'后可以运行.<br />2,在Sql2000下,建立原Sql2000数据库内的所有用户,密码均相同,运行该Sql脚本<br />3,在Sql2000下,对于刚新并运行了Sql脚本的建数据库导入数据,源服务器和数据库选择SQL65<br />下的数据库,导入. 选择所有对象后,再去掉视图,因为我们发现导过来后会把视图也当作一个表处理,<br />但是该视图已经存在,会报错: "已经存在对象..."<br />经过几次尝试数据成功导入,所有的主建,视图,过程等均未丢失.<br /><br />
</div>
<p>以上步是在NT sp6 SqlServer6.5 和Win2000 sp4 SqlServer2000 Sp3a下. <br />再次感谢微软动力营,感谢Mingqing Cheng给我们的帮助! </p>
</div>
<br /><p></p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">09 Feb 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/02/09/pagedsp/" class="post-title">分页存储过程</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-LAMP" href='/tags/lamp'>LAMP</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-SQL Server" href='/tags/sql-server'>SQL Server</a>
                                
                                    <a class="post-category post-category-分页" href='/tags/%E5%88%86%E9%A1%B5'>分页</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>搞了一中午终于可以用了 但不知道效率如何.郁闷的是我要用php去调用它</p>
<p><span style="color: #008000;">  /*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br />    CopyRight：   ******<br />    CreateData：   2004-02-09<br />    Language：   MS SQL SERVER 存储过程<br />    AuthorName：  Meibo Wu</span><br /><span style="color: #008000;">    实现功能：   分页显示当用户选择了图片大分类时(按手机)的数据<br />    参数说明：   @bigtype为大分类<br />    @gid为传入的图片类型           <br />        $PageSize为每页显示的记录数量<br />    @pageindex为当前页码                             <br />    LastUpdate:            <br />    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/<br />CREATE procedure sms_img_page_no_smalltype<br />(<br /> @bigtype nvarchar(20),<br /> @gid int,<br /> @pagesize int,<br /> @pageindex int<br />)<br />as<br />set nocount on<br /> declare @LikeBigType nvarchar(20)<br /> declare @PageLowerBound int<br /> declare @PageUpperBound int<br /> declare @indextable table(id int identity(1,1),nid int)<br />  set @PageLowerBound=(@pageindex-1)*@pagesize<br />  set @PageUpperBound= @PageLowerBound+@pagesize<br />  set @LikeBigType= @bigtype+'%'<br />  set rowcount @PageUpperBound<br /> insert into @indextable(nid)<br />  select  a.col_id<br />   from web_sms_data_img as a join web_sms_data_mobile as q<br />   on a.col_mobile_type=q.col_mobile_type<br />   where </span><a href="mailto:a.col_img_group=@gid"><span style="color: #008000;">a.col_img_group=@gid</span></a><span style="color: #008000;"><br />    and q.col_mobile_comment  like @LikeBigType<br />   order by a.col_id desc <br /> /*<br /> select  @LikeBigType<br /> select * from @indextable <br /> */<br /> select q.col_mobile_comment,<br />  a.col_id,<br />  a.col_img_hits,<br />  a.col_img_dir,<br />  a.col_img_name<br />  from web_sms_data_img as a join web_sms_data_mobile as q<br />   on a.col_mobile_type=q.col_mobile_type<br />    join @indextable  as p<br />    on a.col_id=p.nid<br />  where p.id&gt;@PageLowerBound and p.id&lt;</span><a href="mailto:=@PageUpperBound"><span style="color: #008000;">=@PageUpperBound</span></a><span style="color: #008000;"><br />   and </span><a href="mailto:a.col_img_group=@gid"><span style="color: #008000;">a.col_img_group=@gid</span></a><span style="color: #008000;"><br />   and q.col_mobile_comment like @LikeBigType<br /> <br /> order by p.id</span></p>
<p><span style="color: #008000;">set nocount off<br />GO<br /></span></p>               

                    </div>
                </section>
                
            </div>
            

            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="https://gohugo.io/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src='https://huobazi.github.com/js/all.min.js'></script>

        </div>
    </div>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-56321-3', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
