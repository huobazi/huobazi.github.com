
    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">

    <link rel="stylesheet" href='https://huobazi.aspxboy.com/css/all.min.css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="武眉博" href='https://huobazi.aspxboy.com/index.xml' />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="https://huobazi.aspxboy.com">武眉博</a></h1>
            <h2 class="brand-tagline"> Marble&#39;s blog </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="https://twitter.com/huobazi">
                        <i class="fa fa-twitter"></i> Twitter
                    </a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/huobazi">
                        <i class="fa fa-github-alt"></i> Github
                    </a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://www.linkedin.com/in/huobazi">
                        <i class="fa fa-linkedin"></i> LinkedIn
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href='https://huobazi.aspxboy.com/index.xml'>
                        <i class="fa fa-rss"></i> rss
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">27 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/27/filldatatoexceltemplate/" class="post-title">打开一个Excel模板文件填充数据另存为一个文件</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-它山之石" href='/tags/%E5%AE%83%E5%B1%B1%E4%B9%8B%E7%9F%B3'>它山之石</a>
                                
                                    <a class="post-category post-category-Excel" href='/tags/excel'>Excel</a>
                                
                                    <a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>最近做的东西要求打开一个Excel文件模板后填充数据<br />开始用OleDb连接该Excel文件更新老是出错误 “需要一个可更新的.....“<br /><a href="http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403">http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403</a><br />如果是access这个错误多半是权限引起的 可是我做的是winform 权限是admin啊<br />未果<br />后来用ODBC测试了几个字段 都成功了<br />开始写程序 后发现就有那么2个单元格不听话 提示参数错误<br />郁闷<br /><a href="http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262">http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262</a><br />仍未果<br />没办法翻google<br />获得<br /><a href="http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp">http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp</a><br />用com组件，可行哦，今早上csdn就有网友pm我问是如何搞定的<br />那就写到这里，<br />以下是部分代码，使用前要先按上文中的说明添加Com引用<br />...........<br /><span style="background-color: #d3d3d3;">string strFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Ctemplate%5Ctemplate.tpl"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\template\template.tpl</span></a><span style="background-color: #d3d3d3;">";<br />    string strSaveFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Cexcel%5C%22+System.DateTime.Now.ToString().Replace(%22:%22,%22%22).Replace(%22-%22,%22%22).Replace"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\excel\"+System.DateTime.Now.ToString().Replace(":","").Replace("-","").Replace</span></a><span style="background-color: #d3d3d3;">(" ","")+@".xls";<br />    Excel.Application ThisApplication = new Excel.ApplicationClass();<br />    Excel.Workbook ThisWorkBook;<br />    object missing = System.Reflection.Missing.Value;<br />    try<br />    { <br />     //加载Excel模板文件<br />     ThisWorkBook = ThisApplication.Workbooks.Open(strFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet ThisSheet = (Excel.Worksheet)ThisWorkBook.Sheets[1];<br />     ThisSheet.Cells[7,1] = dtEnd.ToShortDateString();<br />     progressBar.Value = 30;<br />     ThisApplication.Visible = false;<br />     DataRow dr = dt.Rows[0];<br />     for( int i=0; i     {<br />      ThisSheet.Cells[7,i+2] = dr[i].ToString();<br />      progressBar.Value +=1;<br />     }<br />     //更新数据后另存为新文件<br />     ThisSheet.SaveAs(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing);<br />    }<br />    catch{}<br />    finally<br />    {<br />     ThisApplication.Quit();<br />     ThisWorkBook = null;<br />     ThisApplication = null;<br />     //dt = null;<br />    }<br />    try<br />    { //打开刚才生成的Excel文件<br />     Excel.Workbook NewWorkBook;<br />     NewWorkBook = NewApplication.Workbooks.Open(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet NewSheet = (Excel.Worksheet)NewWorkBook.Sheets[1];<br />     NewApplication.Visible = true;</span></p>
<p>//也可以使用System.Diagnostics.Process.Start(strSaveFileName);来打开新文件</p>
<p>    }</p>
<p>打开Excel后进程内会多出一个excel进程<br />需要手工清理<br />参考这片文章</p>
<p><a href="http://www.eggheadcafe.com/articles/20021012.asp">http://www.eggheadcafe.com/articles/20021012.asp</a></p>
<p><a href="http://www.aspxboy.com/476/archive.aspx">http://www.aspxboy.com/476/archive.aspx</a></p>
<p></p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">27 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/27/filldatatoexceltemplate/" class="post-title">打开一个Excel模板文件填充数据另存为一个文件</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-它山之石" href='/tags/%E5%AE%83%E5%B1%B1%E4%B9%8B%E7%9F%B3'>它山之石</a>
                                
                                    <a class="post-category post-category-Excel" href='/tags/excel'>Excel</a>
                                
                                    <a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>最近做的东西要求打开一个Excel文件模板后填充数据<br />开始用OleDb连接该Excel文件更新老是出错误 “需要一个可更新的.....“<br /><a href="http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403">http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403</a><br />如果是access这个错误多半是权限引起的 可是我做的是winform 权限是admin啊<br />未果<br />后来用ODBC测试了几个字段 都成功了<br />开始写程序 后发现就有那么2个单元格不听话 提示参数错误<br />郁闷<br /><a href="http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262">http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262</a><br />仍未果<br />没办法翻google<br />获得<br /><a href="http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp">http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp</a><br />用com组件，可行哦，今早上csdn就有网友pm我问是如何搞定的<br />那就写到这里，<br />以下是部分代码，使用前要先按上文中的说明添加Com引用<br />...........<br /><span style="background-color: #d3d3d3;">string strFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Ctemplate%5Ctemplate.tpl"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\template\template.tpl</span></a><span style="background-color: #d3d3d3;">";<br />    string strSaveFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Cexcel%5C%22+System.DateTime.Now.ToString().Replace(%22:%22,%22%22).Replace(%22-%22,%22%22).Replace"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\excel\"+System.DateTime.Now.ToString().Replace(":","").Replace("-","").Replace</span></a><span style="background-color: #d3d3d3;">(" ","")+@".xls";<br />    Excel.Application ThisApplication = new Excel.ApplicationClass();<br />    Excel.Workbook ThisWorkBook;<br />    object missing = System.Reflection.Missing.Value;<br />    try<br />    { <br />     //加载Excel模板文件<br />     ThisWorkBook = ThisApplication.Workbooks.Open(strFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet ThisSheet = (Excel.Worksheet)ThisWorkBook.Sheets[1];<br />     ThisSheet.Cells[7,1] = dtEnd.ToShortDateString();<br />     progressBar.Value = 30;<br />     ThisApplication.Visible = false;<br />     DataRow dr = dt.Rows[0];<br />     for( int i=0; i     {<br />      ThisSheet.Cells[7,i+2] = dr[i].ToString();<br />      progressBar.Value +=1;<br />     }<br />     //更新数据后另存为新文件<br />     ThisSheet.SaveAs(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing);<br />    }<br />    catch{}<br />    finally<br />    {<br />     ThisApplication.Quit();<br />     ThisWorkBook = null;<br />     ThisApplication = null;<br />     //dt = null;<br />    }<br />    try<br />    { //打开刚才生成的Excel文件<br />     Excel.Workbook NewWorkBook;<br />     NewWorkBook = NewApplication.Workbooks.Open(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet NewSheet = (Excel.Worksheet)NewWorkBook.Sheets[1];<br />     NewApplication.Visible = true;</span></p>
<p>//也可以使用System.Diagnostics.Process.Start(strSaveFileName);来打开新文件</p>
<p>    }</p>
<p>打开Excel后进程内会多出一个excel进程<br />需要手工清理<br />参考这片文章</p>
<p><a href="http://www.eggheadcafe.com/articles/20021012.asp">http://www.eggheadcafe.com/articles/20021012.asp</a></p>
<p><a href="http://www.aspxboy.com/476/archive.aspx">http://www.aspxboy.com/476/archive.aspx</a></p>
<p></p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">26 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/26/cb-7697/" class="post-title">关于 “编译器失败，错误代码为 128”</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Debug" href='/tags/debug'>Debug</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p></p>
<p>csdn上有位兄弟遇到这个错误了<br /><a href="http://expert.csdn.net/Expert/topic/3009/3009791.xml?temp=2.024478E-02">http://expert.csdn.net/Expert/topic/3009/3009791.xml?temp=2.024478E-02</a><br />我先是搜索baidu发现一个帖子<br /><a href="http://www.devmanclub.com/showpost.aspx?PostID=1791">http://www.devmanclub.com/showpost.aspx?PostID=1791</a><br />没有解决办法<br />翻google从gotdotnet翻出<a href="http://www.gotdotnet.com/Community/MessageBoard/Thread.aspx?id=209899&amp;Page=1#209899"><strike>一贴</strike> </a>作者称其为“horrible dream”的错误，并给出解决方案<br /><br /><font style="BACKGROUND-COLOR: #a9a9a9">First of all, update your antivirus software and make a full scan on your computer. I guess the cause of the problem is that some hacker has entered in my computer and made some change in my account and security settings, so the sensitive asp.net found it and then stopped working. <br /><br />After u are sure no viruse is in your computer, u can follow the steps below. <br /><br />1. run "aspnet_regiis -ua" in the cmd. u can start the cmd from the vs.net tools in the start menu, otherwise u need type the full path. <br /><br />2. remove the aspnet account from your computer <br /><br />3. uninstall iis <br /><br />4. restart your computer <br /><br />5. reinstall iis <br /><br />6. run "aspnet_regiss -i" in the cmd <br /><br />7. add vs_developers group to iis operators (u can operation in iis) <br /><br />8. open the file "machine.config" which is in "C:\WINNT\Microsoft.NET\Framework\v1.1.xxxx\CONFIG", then find and replace <br />userName="machine" <br />with <br />userName="SYSTEM" <br /><br />9. restart your computer and pray silently <br /><br /><font style="BACKGROUND-COLOR: #ffffff">地址 </font><a href="http://www.gotdotnet.com/Community/MessageBoard/Thread.aspx?id=209899&amp;Page=1#209899"><font style="BACKGROUND-COLOR: #ffffff">http://www.gotdotnet.com/Community/MessageBoard/Thread.aspx?id=209899&amp;Page=1#209899</font></a><br /><font style="BACKGROUND-COLOR: #ffffff">记在这里，免今后自己和其他朋友遇到<br /><br />---------------------------------------------------------------------------------------------------------<br /><br />2004-7-1补记<br /><br /><font style="BACKGROUND-COLOR: #d3d3d3">我们一个客户机器也出了这个问题<br />咨询了微软动力营专家，专家提出2点：<br />//＝＝＝＝＝以下内容来字微软动力营＝＝＝＝＝＝＝<br />您好！<br />    谢谢您使用微软动力营！<br />    对于你的这个问题，通常都是由于以下两个原因引起的，你可以去查看一下：<br />1. 你的客户的机器可能感染了这个病毒</font><a href="http://de.mcafee.com/root/genericVIL.asp?genericURL=/VirusInfo/VIL/dispVirus.asp&amp;virus_k=100252"><font style="BACKGROUND-COLOR: #d3d3d3">http://de.mcafee.com/root/genericVIL.asp?genericURL=/VirusInfo/VIL/dispVirus.asp&amp;virus_k=100252</font></a><br /></font></font><font style="BACKGROUND-COLOR: #d3d3d3">2. 你的客户的服务器运行着一些防病毒软件(象norton)，这有可能导致了这个错误。</font></p>
<br /><p><font style="BACKGROUND-COLOR: #d3d3d3">对于第一个可能，我提供的那篇网页里面提供了清除方法。对于第二个可能你可以将防病毒软件关闭掉试试。</font></p>
<br /><p><font style="BACKGROUND-COLOR: #d3d3d3">希望对你有帮助</font></p>
<br /><p><font style="BACKGROUND-COLOR: #d3d3d3">谭映辉 [微软]  <br />微软全球技术中心 微软动力营合作伙伴技术支持</font></p>
<br /><p><font style="BACKGROUND-COLOR: #a9a9a9"><font style="BACKGROUND-COLOR: #ffffff"><font style="BACKGROUND-COLOR: #d3d3d3">使您100%满意是"微软动力营"合作伙伴支持服务的唯一目标。我们真诚希望您能够对"微软动力营"服务提出宝贵建议和意见，我们将针对您的反馈不断改进服务质量。如有任何问题，请发信至：<br /></font><a href="mailto:cmsdn@microsoft.com"><font style="BACKGROUND-COLOR: #d3d3d3">cmsdn@microsoft.com</font></a><br /><font style="BACKGROUND-COLOR: #d3d3d3">本贴子以“现状”提供且没有任何担保，同时也没有授予任何权利。</font><br />//＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝<br /></font><br /></font></p>                

                    </div>
                </section>
                
                <h1 class="content-subhead">06 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/06/refreshorreloadparentwindowwithoutconfirm/" class="post-title">弹出窗口刷新它的父页面后。出现不重新发送信息，则无法刷新网页</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-奇技淫巧" href='/tags/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7'>奇技淫巧</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>做的东西弹出一个窗口处理某些动作后刷新父窗口<br />用<br />window.opener.location.reload();<br />刷新<br />如果父窗口在此之前如果有过提交数据的动作，则会出现这么个讨厌的对话筐<br />“不重新发送信息，则无法刷新网页”<br />痛苦......<br />CSDN搜索未果(有几贴都是用Response.Redirect的方法，但我这里是刷父窗口)。<br />痛苦.<br />........<br />翻我的<a href="http://www.aspxboy.com/private/showthread.asp?threadid=148"><strike>小本本</strike></a> 后找到办法<br />用<br />window.opener.location.href=window.opener.location.href<br />去刷新（其实是重定位了一下）父窗口<br />可行。<br />总结： <font style="BACKGROUND-COLOR: #ee82ee">不能一棵树上掉死</font> :P</p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">06 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/06/refreshorreloadparentwindowwithoutconfirm/" class="post-title">弹出窗口刷新它的父页面后。出现不重新发送信息，则无法刷新网页</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-奇技淫巧" href='/tags/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7'>奇技淫巧</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>做的东西弹出一个窗口处理某些动作后刷新父窗口<br />用<br />window.opener.location.reload();<br />刷新<br />如果父窗口在此之前如果有过提交数据的动作，则会出现这么个讨厌的对话筐<br />“不重新发送信息，则无法刷新网页”<br />痛苦......<br />CSDN搜索未果(有几贴都是用Response.Redirect的方法，但我这里是刷父窗口)。<br />痛苦.<br />........<br />翻我的<a href="http://www.aspxboy.com/private/showthread.asp?threadid=148"><strike>小本本</strike></a> 后找到办法<br />用<br />window.opener.location.href=window.opener.location.href<br />去刷新（其实是重定位了一下）父窗口<br />可行。<br />总结： <font style="BACKGROUND-COLOR: #ee82ee">不能一棵树上掉死</font> :P</p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">05 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/05/datagriddeleteconfirm/" class="post-title">DataGrid点击删除按钮弹出确认对话框一个好办法</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><font color="#3366cc"><strong>原文地址<br /><a href="http://expert.csdn.net/Expert/topic/2852/2852126.xml?temp=.4770471">http://expert.csdn.net/Expert/topic/2852/2852126.xml?temp=.4770471</a> <br /></strong></font><font color="#3366cc"><strong>其中<br />wf5360308(峰)</strong></font>提供的方法<br />datagrid-》属性生成器-》列-》添加按钮列-》删除-》文本(T)-&gt;在文本框里加上：<br />&lt;div id="de" onclick="JavaScript:return confirm('确定删除吗？')"&gt;删除&lt;/div&gt;<br /><br />不错的办法哦～<br /></p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">05 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/05/datagriddeleteconfirm/" class="post-title">DataGrid点击删除按钮弹出确认对话框一个好办法</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><font color="#3366cc"><strong>原文地址<br /><a href="http://expert.csdn.net/Expert/topic/2852/2852126.xml?temp=.4770471">http://expert.csdn.net/Expert/topic/2852/2852126.xml?temp=.4770471</a> <br /></strong></font><font color="#3366cc"><strong>其中<br />wf5360308(峰)</strong></font>提供的方法<br />datagrid-》属性生成器-》列-》添加按钮列-》删除-》文本(T)-&gt;在文本框里加上：<br />&lt;div id="de" onclick="JavaScript:return confirm('确定删除吗？')"&gt;删除&lt;/div&gt;<br /><br />不错的办法哦～<br /></p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">05 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/05/datagridheadertextinitemdatabound/" class="post-title">如何在ItemDataBound内获得DataGrid的列名称HeaderText</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>如果 AutoGenerateColumns=&ldquo;false&rdquo; 使用绑定列，模板列
则比较好办，直接使用 YourDataGrid.Columns[编号].HeaderText 获得
可是,如果 AutoGenerateColumns=&ldquo;true&rdquo; ,就比较麻烦了,因为这时YourDataGrid.Columns.Count是0
但是可以变通做到。</p>

<pre><code>&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; %&gt;
&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;gb2312&quot; lang=&quot;gb2312&quot;&gt;
&lt;head&gt;
&lt;title&gt; ItemDataBoundGetColumnName &lt;/title&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gb2312&quot; /&gt;
&lt;meta name=&quot;title&quot; content=&quot;&quot; /&gt;
&lt;meta name=&quot;author&quot; content=&quot;活靶子,Huobazi,www.AspxBoy.com&quot; /&gt;
&lt;meta name=&quot;subject&quot; content=&quot;&quot; /&gt;
&lt;meta name=&quot;language&quot; content=&quot;gb2312&quot; /&gt;
&lt;meta name=&quot;keywords&quot; content=&quot;&quot; /&gt;
&lt;meta name=&quot;Copyright&quot; content=&quot;www.AspxBoy.com&quot; /&gt;
&lt;meta name=&quot;robots&quot; content=&quot;all&quot; /&gt;
&lt;script language=&quot;c#&quot; runat=&quot;server&quot;&gt;
void BindGrid()
{
        DataTable dt = new DataTable();
        DataRow dr;
        dt.Columns.Add(new DataColumn(&quot;IntegerValue&quot;, typeof(Int32)));
        dt.Columns.Add(new DataColumn(&quot;StringValue&quot;, typeof(string)));
        dt.Columns.Add(new DataColumn(&quot;DateTimeValue&quot;, typeof(DateTime)));
        dt.Columns.Add(new DataColumn(&quot;BoolValue&quot;, typeof(bool)));
        dt.Columns.Add(new DataColumn(&quot;CurrencyValue&quot;, typeof(double)));
        for (int i = 0; i &lt; 36; i++) {
            dr = dt.NewRow();
            dr[0] = i;
            dr[1] = &quot;项 &quot; + i.ToString();
            dr[2] = DateTime.Now;
            dr[3] = (i % 2 != 0) ? true : false;
            dr[4] = 1.23 * (i+1);
            dt.Rows.Add(dr);
        }
  dg.DataSource= dt;
  dg.DataBind();
}
void Page_Load(object o, EventArgs e)
{
     dg.PagerStyle.Mode = PagerMode.NumericPages;
     if(!IsPostBack)
     {
        BindGrid();
     }
}
 
void btnClick(object o , EventArgs e)
{
     Response.Write(&quot;页面回发,但是不执行ItemDataBound&quot;);
}
 
void PageChange(object o , DataGridPageChangedEventArgs e)
{
     dg.CurrentPageIndex = e.NewPageIndex;
     BindGrid();
}
void ItemDataBound(object o , DataGridItemEventArgs e)
{
     if(e.Item.ItemIndex &gt; -1 )//必须
     {
          DataRowView drv = (DataRowView)e.Item.DataItem;
          for (int i=0; i&lt;drv.Row.Table.Columns.Count ; i++)
          {  
            Response.Write(drv.Row.Table.Columns[i].ColumnName + &quot;  &quot;);
          }
     }
}
&lt;/script&gt;
 
&lt;/head&gt;
&lt;body&gt;
&lt;form runat=&quot;server&quot;&gt;
  &lt;ASP:DataGrid id=&quot;dg&quot; runat=&quot;server&quot;       
   HeaderStyle-BackColor=&quot;#aaaadd&quot;
   AutoGenerateColumns=&quot;true&quot;
   AllowPaging=&quot;true&quot;
   PageSize=&quot;6&quot;
    OnItemDataBound=&quot;ItemDataBound&quot;
    OnPageIndexChanged=&quot;PageChange&quot;
  &gt;
  &lt;/asp:DataGrid&gt;
  &lt;/br&gt;
   &lt;asp:button id=&quot;btn&quot; runat=&quot;server&quot; onclick=&quot;btnClick&quot; Text=&quot;我是按钮,按我一下&quot;&gt;&lt;/asp:button&gt;
   &lt;p&gt;在AutoGenerateColumns=&quot;false&quot;使用绑定列或者模板列的时候只需要使用 &lt;/P&gt;
   &lt;p&gt;&lt;font color=&quot;blut&quot;&gt;YourDataGrid.Columns[编号].HeaderText&lt;/font&gt; 去获取
  &lt;/P&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
 
</code></pre>

                    </div>
                </section>
                
                <h1 class="content-subhead">05 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/05/datagridheadertextinitemdatabound/" class="post-title">如何在ItemDataBound内获得DataGrid的列名称HeaderText</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>如果 AutoGenerateColumns=&ldquo;false&rdquo; 使用绑定列，模板列
则比较好办，直接使用 YourDataGrid.Columns[编号].HeaderText 获得
可是,如果 AutoGenerateColumns=&ldquo;true&rdquo; ,就比较麻烦了,因为这时YourDataGrid.Columns.Count是0
但是可以变通做到。</p>

<pre><code>&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; %&gt;
&lt;%@ Import Namespace=&quot;System.Data&quot; %&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;gb2312&quot; lang=&quot;gb2312&quot;&gt;
&lt;head&gt;
&lt;title&gt; ItemDataBoundGetColumnName &lt;/title&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gb2312&quot; /&gt;
&lt;meta name=&quot;title&quot; content=&quot;&quot; /&gt;
&lt;meta name=&quot;author&quot; content=&quot;活靶子,Huobazi,www.AspxBoy.com&quot; /&gt;
&lt;meta name=&quot;subject&quot; content=&quot;&quot; /&gt;
&lt;meta name=&quot;language&quot; content=&quot;gb2312&quot; /&gt;
&lt;meta name=&quot;keywords&quot; content=&quot;&quot; /&gt;
&lt;meta name=&quot;Copyright&quot; content=&quot;www.AspxBoy.com&quot; /&gt;
&lt;meta name=&quot;robots&quot; content=&quot;all&quot; /&gt;
&lt;script language=&quot;c#&quot; runat=&quot;server&quot;&gt;
void BindGrid()
{
        DataTable dt = new DataTable();
        DataRow dr;
        dt.Columns.Add(new DataColumn(&quot;IntegerValue&quot;, typeof(Int32)));
        dt.Columns.Add(new DataColumn(&quot;StringValue&quot;, typeof(string)));
        dt.Columns.Add(new DataColumn(&quot;DateTimeValue&quot;, typeof(DateTime)));
        dt.Columns.Add(new DataColumn(&quot;BoolValue&quot;, typeof(bool)));
        dt.Columns.Add(new DataColumn(&quot;CurrencyValue&quot;, typeof(double)));
        for (int i = 0; i &lt; 36; i++) {
            dr = dt.NewRow();
            dr[0] = i;
            dr[1] = &quot;项 &quot; + i.ToString();
            dr[2] = DateTime.Now;
            dr[3] = (i % 2 != 0) ? true : false;
            dr[4] = 1.23 * (i+1);
            dt.Rows.Add(dr);
        }
  dg.DataSource= dt;
  dg.DataBind();
}
void Page_Load(object o, EventArgs e)
{
     dg.PagerStyle.Mode = PagerMode.NumericPages;
     if(!IsPostBack)
     {
        BindGrid();
     }
}
 
void btnClick(object o , EventArgs e)
{
     Response.Write(&quot;页面回发,但是不执行ItemDataBound&quot;);
}
 
void PageChange(object o , DataGridPageChangedEventArgs e)
{
     dg.CurrentPageIndex = e.NewPageIndex;
     BindGrid();
}
void ItemDataBound(object o , DataGridItemEventArgs e)
{
     if(e.Item.ItemIndex &gt; -1 )//必须
     {
          DataRowView drv = (DataRowView)e.Item.DataItem;
          for (int i=0; i&lt;drv.Row.Table.Columns.Count ; i++)
          {  
            Response.Write(drv.Row.Table.Columns[i].ColumnName + &quot;  &quot;);
          }
     }
}
&lt;/script&gt;
 
&lt;/head&gt;
&lt;body&gt;
&lt;form runat=&quot;server&quot;&gt;
  &lt;ASP:DataGrid id=&quot;dg&quot; runat=&quot;server&quot;       
   HeaderStyle-BackColor=&quot;#aaaadd&quot;
   AutoGenerateColumns=&quot;true&quot;
   AllowPaging=&quot;true&quot;
   PageSize=&quot;6&quot;
    OnItemDataBound=&quot;ItemDataBound&quot;
    OnPageIndexChanged=&quot;PageChange&quot;
  &gt;
  &lt;/asp:DataGrid&gt;
  &lt;/br&gt;
   &lt;asp:button id=&quot;btn&quot; runat=&quot;server&quot; onclick=&quot;btnClick&quot; Text=&quot;我是按钮,按我一下&quot;&gt;&lt;/asp:button&gt;
   &lt;p&gt;在AutoGenerateColumns=&quot;false&quot;使用绑定列或者模板列的时候只需要使用 &lt;/P&gt;
   &lt;p&gt;&lt;font color=&quot;blut&quot;&gt;YourDataGrid.Columns[编号].HeaderText&lt;/font&gt; 去获取
  &lt;/P&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
 
</code></pre>

                    </div>
                </section>
                
                <h1 class="content-subhead">05 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/05/cb-5210/" class="post-title">这次吵的更凶了！！</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-程序员" href='/tags/%E7%A8%8B%E5%BA%8F%E5%91%98'>程序员</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>1 <a href="http://blog.joycode.com/5drush/posts/18249.aspx">http://blog.joycode.com/5drush/posts/18249.aspx</a><br />从而引出<br />2 <a href="http://blog.codelphi.com/virushuo/posts/3453.aspx">http://blog.codelphi.com/virushuo/posts/3453.aspx</a><br />再<br />3 <a href="http://blog.codelphi.com/netfire/posts/3469.aspx">http://blog.codelphi.com/netfire/posts/3469.aspx</a><br />我个人认为<br />MVPs是一群值得佩服的人，因为我身边就有<a href="http://www.webdiyer.com">一位</a> 。如果你知道了他的一些情况你将更佩服他！<br />不同意文中“国内的大半都是靠论坛灌水得到”，<br />我认为热心于帮助别人的人最值得敬佩的！！！</p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">14 Mar 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/03/14/cb-3113/" class="post-title">一个比较郁闷的问题</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>我在我的主页 <a href="http://www.AspxBoy.com">http://www.AspxBoy.com</a> 内<br />文章显示页面是在添加文章的时候生成的静态htm页。<br />在首页和其他栏目显示文章列表时链接为<br /><a href="http://www.aspxboy.com/ShowArticle.Aspx?ID=214">http://www.aspxboy.com/ShowArticle.Aspx?ID=214</a><br />这样的链接<br />在ShowArticle.Aspx内为文章的被阅读次数加1，跳转到（<span style="color: #ff3333;"><strong>Response.Redirect</strong></span>）相应的Html文件<br />如<br /><a href="http://www.aspxboy.com/Files/71/66/20039280037.htm">http://www.aspxboy.com/Files/71/66/20039280037.htm</a><br />最近发现这样的设计导致搜索引擎抓取不到页面<img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg" alt=""><br />好友<a href="http://0day.com.cn">龙龙</a>放出他的<a href="http://home.0day.com.cn/search.php">龙族蜘蛛</a>在我的站内老是抓取不到任何可用链接<img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg" alt="">,只能抓到首页就进行不下去了......<br />不只该如何解决，郁闷啊。</p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">14 Mar 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/03/14/cb-3113/" class="post-title">一个比较郁闷的问题</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>我在我的主页 <a href="http://www.AspxBoy.com">http://www.AspxBoy.com</a> 内<br />文章显示页面是在添加文章的时候生成的静态htm页。<br />在首页和其他栏目显示文章列表时链接为<br /><a href="http://www.aspxboy.com/ShowArticle.Aspx?ID=214">http://www.aspxboy.com/ShowArticle.Aspx?ID=214</a><br />这样的链接<br />在ShowArticle.Aspx内为文章的被阅读次数加1，跳转到（<span style="color: #ff3333;"><strong>Response.Redirect</strong></span>）相应的Html文件<br />如<br /><a href="http://www.aspxboy.com/Files/71/66/20039280037.htm">http://www.aspxboy.com/Files/71/66/20039280037.htm</a><br />最近发现这样的设计导致搜索引擎抓取不到页面<img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg" alt=""><br />好友<a href="http://0day.com.cn">龙龙</a>放出他的<a href="http://home.0day.com.cn/search.php">龙族蜘蛛</a>在我的站内老是抓取不到任何可用链接<img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg" alt="">,只能抓到首页就进行不下去了......<br />不只该如何解决，郁闷啊。</p>               

                    </div>
                </section>
                
            </div>
            
<div class="pagination">
  <nav role="pagination" class="post-list-pagination">
      
      <a href="/tags/asp.net/page/13/" class="post-list-pagination-item pure-button post-list-pagination-item-prev">
        <i class="fa fa-angle-double-left"></i>&nbsp;Newer
      </a>
      
    <span class="post-list-pagination-item post-list-pagination-item-current">Page 14 of 16</span>
    
      <a href="/tags/asp.net/page/15/" class="post-list-pagination-item pure-button post-list-pagination-item-next">
        Older&nbsp;<i class="fa fa-angle-double-right"></i>
      </a>
    
  </nav>
</div>


            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="https://gohugo.io/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src='https://huobazi.aspxboy.com/js/all.min.js'></script>

        </div>
    </div>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-56321-3', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
