
    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">

    <link rel="stylesheet" href='https://huobazi.github.com/css/all.min.css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="武眉博" href='https://huobazi.github.com/index.xml' />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="https://huobazi.github.com">武眉博</a></h1>
            <h2 class="brand-tagline"> Marble&#39;s blog </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="https://twitter.com/huobazi">
                        <i class="fa fa-twitter"></i> Twitter
                    </a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/huobazi">
                        <i class="fa fa-github-alt"></i> Github
                    </a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://www.linkedin.com/in/huobazi">
                        <i class="fa fa-linkedin"></i> LinkedIn
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href='https://huobazi.github.com/index.xml'>
                        <i class="fa fa-rss"></i> rss
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">11 May 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/05/11/cb-8865/" class="post-title">TechNet月度光盘资料&#43;贺卡&#43;msn贴纸&#43;TechNet体恤 被哄抢而光</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-.Net其他" href='/tags/.net%E5%85%B6%E4%BB%96'>.Net其他</a>
                                
                                    <a class="post-category post-category-TechNet" href='/tags/technet'>TechNet</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>前阵子换了工作，没有及时的更新TechNet的资料4月份的光盘资料被寄到原来单位去了<br />连同一张贺卡，msn贴纸，TechNet的体恤 昨天同事带给了我。<br />好消息和MM共享之... ...</p>
<p>随之贺卡和msn贴纸全部被没收（单人哄抢），XL号的体恤我竟然穿上象紧身装(PS:俺190多斤重的)，也被剥夺，MM曰：这体恤我晚上穿出去乘凉，宽宽松松的，刚好。</p>
<p>55555......</p>
<p>一堆东西只剩下张光盘是我的了。<br />MM的话“微软是关心你们这些开发人员，不想让你们打光棍，这些卡啊贴纸啊的就是让你送女朋友的！”<br />惊人之语啊～～<br />当然MM也不忘抚慰一下我，把贴纸里那只美丽的MSN蝴蝶贴在我的手机上，剩下的MSN小人一个也不许我要了</p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">07 May 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/05/07/cb-8466/" class="post-title">一个好地方～SharpLibrary</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><a href="http://24.199.8.122/" target="_blank"><img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg49" border="0"></a></p>              

                    </div>
                </section>
                
                <h1 class="content-subhead">07 May 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/05/07/cb-8466/" class="post-title">一个好地方～SharpLibrary</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><a href="http://24.199.8.122/" target="_blank"><img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg49" border="0"></a></p>              

                    </div>
                </section>
                
                <h1 class="content-subhead">30 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/04/30/cb-8176/" class="post-title">一个关于DataGrid的打印类,分享,感谢作者</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-.Net其他" href='/tags/.net%E5%85%B6%E4%BB%96'>.Net其他</a>
                                
                                    <a class="post-category post-category-Print" href='/tags/print'>Print</a>
                                
                                    <a class="post-category post-category-DataGrid" href='/tags/datagrid'>DataGrid</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><p><font size="2">手中的活计需要打印,就到处找找。<br />从</font><a href="http://www.google.com/"><font size="2">google</font></a><font size="2">中扑获,挺不错的，大家共享～<br />how can i print the data in DataGrid?</font><a href="http://forums.aspfree.com/archive/t-17107"><br /><font size="2"><a href="http://forums.aspfree.com/archive/t-17107">http://forums.aspfree.com/archive/t-17107</a></font></a><br /><a href="http://forums.aspfree.com/t17107/s.html"><font size="2"><a href="http://forums.aspfree.com/t17107/s.html">http://forums.aspfree.com/t17107/s.html</a></font></a><br /></p>
<pre>using System;
using System.Collections;
using System.ComponentModel;
using System.Drawing;
using System.Drawing.Printing;
using System.Data;</p>

<p>using System.Windows.Forms;</p>

<p>namespace Hooooo.Print
{
public class DataGridPrinter
{
private DataGrid dataGrid;
private PrintDocument printDocument;
private PageSetupDialog pageSetupDialog;
private PrintPreviewDialog printPreviewDialog;</p>

<p>public DataGridPrinter(DataGrid dataGrid)
{
this.dataGrid = dataGrid;
printDocument = new PrintDocument();
printDocument.PrintPage += new PrintPageEventHandler(this.printDocument_PrintPage);
}</p>

<p>private void printDocument_PrintPage(object sender, System.Drawing.Printing.PrintPageEventArgs e)
{
int rowCount = 0;
int colCount = 0;
int x = 0;
int y = 0;
int rowGap = 20;
int colGap = 5;
int leftMargin = 50;
Font font = new Font(&ldquo;Arial&rdquo;, 10);
Font headingFont = new Font(&ldquo;Arial&rdquo;, 11, FontStyle.Underline);
Font captionFont = new Font(&ldquo;Arial&rdquo;, 10, FontStyle.Bold);
Brush brush = new SolidBrush(Color.Black);
string cellValue = &ldquo;&rdquo;;</p>

<p>if(dataGrid.DataSource.GetType().ToString() == &ldquo;System.Data.DataTable&rdquo;)
{
rowCount = ((DataTable)dataGrid.DataSource).Rows.Count;
}
else if(dataGrid.DataSource.GetType().ToString() == &ldquo;System.Collections.ArrayList&rdquo;)
{
rowCount = ((ArrayList)dataGrid.DataSource).Count;
}
colCount = dataGrid.TableStyles[0].GridColumnStyles.Count;</p>

<p>//print caption
if(dataGrid.CaptionVisible)
{
y += rowGap;
x = leftMargin;
e.Graphics.DrawString(dataGrid.CaptionText, captionFont, brush, x, y);
}</p>

<p>//print headings
y += rowGap;
x = leftMargin;
for(int j = 0; j &lt; colCount; j++)
{
if(dataGrid.TableStyles[0].GridColumnStyles[j].Width &gt; 0)
{
cellValue = dataGrid.TableStyles[0].GridColumnStyles[j].HeaderText;
e.Graphics.DrawString(cellValue, headingFont, brush, x, y);
x += dataGrid.TableStyles[0].GridColumnStyles[j].Width + colGap;
}
}</p>

<p>//print all rows
for(int i = 0; i &lt; rowCount; i++)
{
y += rowGap;
x = leftMargin;
for(int j = 0; j &lt; colCount; j++)
{
if(dataGrid.TableStyles[0].GridColumnStyles[j].Width &gt; 0)
{
cellValue = dataGrid[i,j].ToString();
e.Graphics.DrawString(cellValue, font, brush, x, y);
x += dataGrid.TableStyles[0].GridColumnStyles[j].Width + colGap;
y = y + rowGap * (cellValue.Split(new char[] {&rsquo;\r&rsquo;, &lsquo;\n&rsquo;}).Length - 1);
}
}
}
string s = cellValue;
string f3 = cellValue;
}</p>

<p>public PrintDocument GetPrintDocument()
{
return printDocument;
}</p>

<p>public void Print()
{
try
{
pageSetupDialog = new PageSetupDialog();
pageSetupDialog.Document = printDocument;
pageSetupDialog.ShowDialog();
printPreviewDialog = new PrintPreviewDialog();
printPreviewDialog.Document = printDocument;
printPreviewDialog.Height = 600;
printPreviewDialog.Width = 800;
printPreviewDialog.ShowDialog();
}
catch(Exception e)
{
throw new Exception(&ldquo;Printer error.&rdquo; + e.Message);
}</p>

<p>}
}
}
</pre>
<p><br />需要打印表格线条及分页的朋友，可以看一下下面这篇文章：<br /> <br /></p>
<div><strong><font face="Verdana" size="4"><a title="How to Print a DataGrid in C# and .NET" style="COLOR: #0000ff" href="http://www.c-sharpcorner.com/Graphics/DataGridPrinterMG.asp" target="_blank"><strong><font face="Verdana" size="4">How to Print a DataGrid in C# and .NET</font> </strong></a><br /><br /></font><br /><div></div>
<div>
<img style="WIDTH: 672px; HEIGHT: 352px" height="245" src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg50" width="510"> </div>
<div> </div>
<div></div>
<p></p></strong></div></p>

                    </div>
                </section>
                
                <h1 class="content-subhead">30 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/04/30/confirmbutton/" class="post-title">可以弹出确认对话框的自定义Web服务器控件ConfirmButton</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-自定义控件" href='/tags/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6'>自定义控件</a>
                                
                                    <a class="post-category post-category-ConfirmButton" href='/tags/confirmbutton'>ConfirmButton</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">经常在论坛里看到类似这样的问题：“</span><span lang="EN-US">…</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如何在点击删除按钮的时候弹出个确认删除对话框”。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">下面我们来自己写一个这样的自定义</span><span lang="EN-US">Web</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">服务器控件</span><span lang="EN-US">!</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">思路如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">继承</span><span lang="EN-US">System.Web.UI.WebControls.Button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">控件</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">增加一个属性“</span><span lang="EN-US">ConfirmMessage</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”来表示弹出确认框上面的提示信息。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在服务器控件呈现在页面之前把一段</span><span lang="EN-US">javascript</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">写到页面</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">内容如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;script language="JavaScript"&gt;<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;!--<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">function _doAspxBoyConfirm()<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy">return confirm("</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">你确认删除</span><span lang="EN-US" style="COLOR: navy">/</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">保存吗</span><span lang="EN-US" style="COLOR: navy">??")<p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">//--&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;/script&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">查一下</span><span lang="EN-US">msdn</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中对于</span><b><span lang="EN-US" style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto">Control.OnPreRender</span></b><span lang="EN-US"> </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">方法<span class="ilang">的描述</span></span><b><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可以得到“<b><span style="COLOR: navy">此方法通知服务器控件在保存视图状态和呈现内容之前，执行任何必要的预呈现步骤</span></b></span><span lang="EN-US">”.</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">所以我们只要在</span><b><span lang="EN-US" style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto">OnPreRender</span></b><b><span style="BACKGROUND: #d9d9d9; COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-shading: white; mso-pattern: gray-15 auto">方法内</span><span style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto"> </span></b><b><span style="BACKGROUND: #d9d9d9; COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-shading: white; mso-pattern: gray-15 auto">用</span></b><span lang="EN-US">Page.RegisterClientScriptBlock</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">把这段</span><span lang="EN-US">javascript</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">发送到客户端，并且给</span><span lang="EN-US">Button. Attributes</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">属性内添加一个“</span><span lang="EN-US">onclick</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”的客户端属性对应值为</span><span lang="EN-US">: "return _doAspxBoyConfirm()”.</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">详细情况可以查阅</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font size="3">ms-help://MS.VSCC.2003/MS.MSDNQTR.2003FEB.2052/cpref/html/frlrfsystemwebuiwebcontrolswebcontrolclassattributestopic.htm</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这样一个具有</span><span lang="EN-US">ConFirm</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">功能的</span><span lang="EN-US">Button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">就基本上建立起来了。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">新建一个测试该控件的工程</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在工具箱上点右键选择“添加</span><span lang="EN-US">/</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">移除项”，点击浏览选择编译好的</span><span lang="EN-US">dll</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">文件，点击确定，你会发现</span><span lang="EN-US">ConFirmButton</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">已经添加到工具箱内了</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">将其托到一个</span><span lang="EN-US">Aspx</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">页面内</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在属性设置内给</span><span lang="EN-US">ConfirmMessage</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">值为你要的弹出框内容比如“确定删除吗</span><span lang="EN-US">?</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”，按</span><span lang="EN-US">F5</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">运行。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当点该按钮时会弹出一个</span><span lang="EN-US">confirm</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">对话框询问“确定删除吗</span><span lang="EN-US">?</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”</span><span lang="EN-US">,</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果点击确定则执行</span><span lang="EN-US">button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的</span><span lang="EN-US">Button_Click</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">事件，如果点击取消则不执行。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">你可以查看他生成的</span><span lang="EN-US">html</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">代码，以加深对该控件工作原理的理解</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">完整的代码如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Web.UI;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Web.UI.WebControls;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.ComponentModel;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Text;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">namespace AspxBoy.Com.ConfirmButton<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>/// &lt;summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy"><span style="mso-tab-count: 1">       </span>/// Button</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">点击时会弹出一个对话框要求确认</span><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>/// &lt;/summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>public class ConfirmButton : System.Web.UI.WebControls.Button<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span><span style="mso-tab-count: 1">       </span>private string _confirmMessage;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>/// &lt;summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy"><span style="mso-tab-count: 2">              </span>/// </span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当客户端点击此</span><span lang="EN-US" style="COLOR: navy">Button</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">时弹出的提示消息筐的内容</span><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>/// &lt;/summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public string ConfirmMessage<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>get<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span><span style="mso-tab-count: 1">       </span>return _confirmMessage;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>set<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span><span style="mso-tab-count: 1">       </span>_confirmMessage = value;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span><span style="mso-tab-count: 1">       </span>protected override void OnPreRender(System.EventArgs e)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>StringBuilder sb = new StringBuilder();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;script language=\"JavaScript\"&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;!--");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("/*--------------------------------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("ControlName:\t\tAspxBoy.Com.ConfirmButton");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("AuthorName:\t\t\tHuobazi,WuMeibo");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("CopyRight:\t\t\twww.github.Com");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("---------------------------------------------*/");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("function _doAspxBoyConfirm()");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("{");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("return confirm(\"");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(ConfirmMessage);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("\")");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("}");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("//--&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;/script&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>Page.RegisterClientScriptBlock("_doAspxBoyConfirm",sb.ToString());<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>this.Attributes.Add("onclick","return _doAspxBoyConfirm()");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.OnPreRender(e);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public override void RenderBeginTag(HtmlTextWriter writer)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!-------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("AspxBoy.Com.ConfirmButton Start");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("\tAuthorName: \tHuobazi");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine(" ---------------------&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!-------------------- ");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("Copyright:2004 Huobazi(www.github.com)");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write(" ---------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine("&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.RenderBeginTag(writer);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public override void RenderEndTag(HtmlTextWriter writer)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.RenderEndTag(writer);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!------------------------------- ");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("AspxBoy.Com.ConfirmButton<span style="mso-spacerun: yes">  </span>End");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write(" --------------------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine("&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">}<p></p></font></span></b></p>
<p><br /></p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">30 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/04/30/confirmbutton/" class="post-title">可以弹出确认对话框的自定义Web服务器控件ConfirmButton</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-自定义控件" href='/tags/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6'>自定义控件</a>
                                
                                    <a class="post-category post-category-ConfirmButton" href='/tags/confirmbutton'>ConfirmButton</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">经常在论坛里看到类似这样的问题：“</span><span lang="EN-US">…</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如何在点击删除按钮的时候弹出个确认删除对话框”。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">下面我们来自己写一个这样的自定义</span><span lang="EN-US">Web</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">服务器控件</span><span lang="EN-US">!</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">思路如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">继承</span><span lang="EN-US">System.Web.UI.WebControls.Button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">控件</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">增加一个属性“</span><span lang="EN-US">ConfirmMessage</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”来表示弹出确认框上面的提示信息。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在服务器控件呈现在页面之前把一段</span><span lang="EN-US">javascript</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">写到页面</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">内容如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;script language="JavaScript"&gt;<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;!--<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">function _doAspxBoyConfirm()<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy">return confirm("</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">你确认删除</span><span lang="EN-US" style="COLOR: navy">/</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">保存吗</span><span lang="EN-US" style="COLOR: navy">??")<p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">//--&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;/script&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">查一下</span><span lang="EN-US">msdn</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中对于</span><b><span lang="EN-US" style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto">Control.OnPreRender</span></b><span lang="EN-US"> </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">方法<span class="ilang">的描述</span></span><b><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可以得到“<b><span style="COLOR: navy">此方法通知服务器控件在保存视图状态和呈现内容之前，执行任何必要的预呈现步骤</span></b></span><span lang="EN-US">”.</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">所以我们只要在</span><b><span lang="EN-US" style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto">OnPreRender</span></b><b><span style="BACKGROUND: #d9d9d9; COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-shading: white; mso-pattern: gray-15 auto">方法内</span><span style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto"> </span></b><b><span style="BACKGROUND: #d9d9d9; COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-shading: white; mso-pattern: gray-15 auto">用</span></b><span lang="EN-US">Page.RegisterClientScriptBlock</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">把这段</span><span lang="EN-US">javascript</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">发送到客户端，并且给</span><span lang="EN-US">Button. Attributes</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">属性内添加一个“</span><span lang="EN-US">onclick</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”的客户端属性对应值为</span><span lang="EN-US">: "return _doAspxBoyConfirm()”.</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">详细情况可以查阅</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font size="3">ms-help://MS.VSCC.2003/MS.MSDNQTR.2003FEB.2052/cpref/html/frlrfsystemwebuiwebcontrolswebcontrolclassattributestopic.htm</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这样一个具有</span><span lang="EN-US">ConFirm</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">功能的</span><span lang="EN-US">Button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">就基本上建立起来了。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">新建一个测试该控件的工程</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在工具箱上点右键选择“添加</span><span lang="EN-US">/</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">移除项”，点击浏览选择编译好的</span><span lang="EN-US">dll</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">文件，点击确定，你会发现</span><span lang="EN-US">ConFirmButton</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">已经添加到工具箱内了</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">将其托到一个</span><span lang="EN-US">Aspx</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">页面内</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在属性设置内给</span><span lang="EN-US">ConfirmMessage</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">值为你要的弹出框内容比如“确定删除吗</span><span lang="EN-US">?</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”，按</span><span lang="EN-US">F5</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">运行。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当点该按钮时会弹出一个</span><span lang="EN-US">confirm</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">对话框询问“确定删除吗</span><span lang="EN-US">?</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”</span><span lang="EN-US">,</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果点击确定则执行</span><span lang="EN-US">button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的</span><span lang="EN-US">Button_Click</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">事件，如果点击取消则不执行。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">你可以查看他生成的</span><span lang="EN-US">html</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">代码，以加深对该控件工作原理的理解</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">完整的代码如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Web.UI;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Web.UI.WebControls;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.ComponentModel;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Text;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">namespace AspxBoy.Com.ConfirmButton<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>/// &lt;summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy"><span style="mso-tab-count: 1">       </span>/// Button</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">点击时会弹出一个对话框要求确认</span><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>/// &lt;/summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>public class ConfirmButton : System.Web.UI.WebControls.Button<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span><span style="mso-tab-count: 1">       </span>private string _confirmMessage;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>/// &lt;summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy"><span style="mso-tab-count: 2">              </span>/// </span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当客户端点击此</span><span lang="EN-US" style="COLOR: navy">Button</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">时弹出的提示消息筐的内容</span><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>/// &lt;/summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public string ConfirmMessage<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>get<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span><span style="mso-tab-count: 1">       </span>return _confirmMessage;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>set<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span><span style="mso-tab-count: 1">       </span>_confirmMessage = value;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span><span style="mso-tab-count: 1">       </span>protected override void OnPreRender(System.EventArgs e)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>StringBuilder sb = new StringBuilder();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;script language=\"JavaScript\"&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;!--");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("/*--------------------------------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("ControlName:\t\tAspxBoy.Com.ConfirmButton");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("AuthorName:\t\t\tHuobazi,WuMeibo");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("CopyRight:\t\t\twww.github.Com");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("---------------------------------------------*/");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("function _doAspxBoyConfirm()");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("{");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("return confirm(\"");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(ConfirmMessage);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("\")");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("}");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("//--&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;/script&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>Page.RegisterClientScriptBlock("_doAspxBoyConfirm",sb.ToString());<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>this.Attributes.Add("onclick","return _doAspxBoyConfirm()");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.OnPreRender(e);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public override void RenderBeginTag(HtmlTextWriter writer)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!-------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("AspxBoy.Com.ConfirmButton Start");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("\tAuthorName: \tHuobazi");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine(" ---------------------&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!-------------------- ");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("Copyright:2004 Huobazi(www.github.com)");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write(" ---------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine("&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.RenderBeginTag(writer);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public override void RenderEndTag(HtmlTextWriter writer)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.RenderEndTag(writer);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!------------------------------- ");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("AspxBoy.Com.ConfirmButton<span style="mso-spacerun: yes">  </span>End");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write(" --------------------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine("&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">}<p></p></font></span></b></p>
<p><br /></p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">27 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/04/27/filldatatoexceltemplate/" class="post-title">打开一个Excel模板文件填充数据另存为一个文件</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-它山之石" href='/tags/%E5%AE%83%E5%B1%B1%E4%B9%8B%E7%9F%B3'>它山之石</a>
                                
                                    <a class="post-category post-category-Excel" href='/tags/excel'>Excel</a>
                                
                                    <a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>最近做的东西要求打开一个Excel文件模板后填充数据<br />开始用OleDb连接该Excel文件更新老是出错误 “需要一个可更新的.....“<br /><a href="http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403">http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403</a><br />如果是access这个错误多半是权限引起的 可是我做的是winform 权限是admin啊<br />未果<br />后来用ODBC测试了几个字段 都成功了<br />开始写程序 后发现就有那么2个单元格不听话 提示参数错误<br />郁闷<br /><a href="http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262">http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262</a><br />仍未果<br />没办法翻google<br />获得<br /><a href="http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp">http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp</a><br />用com组件，可行哦，今早上csdn就有网友pm我问是如何搞定的<br />那就写到这里，<br />以下是部分代码，使用前要先按上文中的说明添加Com引用<br />...........<br /><span style="background-color: #d3d3d3;">string strFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Ctemplate%5Ctemplate.tpl"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\template\template.tpl</span></a><span style="background-color: #d3d3d3;">";<br />    string strSaveFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Cexcel%5C%22+System.DateTime.Now.ToString().Replace(%22:%22,%22%22).Replace(%22-%22,%22%22).Replace"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\excel\"+System.DateTime.Now.ToString().Replace(":","").Replace("-","").Replace</span></a><span style="background-color: #d3d3d3;">(" ","")+@".xls";<br />    Excel.Application ThisApplication = new Excel.ApplicationClass();<br />    Excel.Workbook ThisWorkBook;<br />    object missing = System.Reflection.Missing.Value;<br />    try<br />    { <br />     //加载Excel模板文件<br />     ThisWorkBook = ThisApplication.Workbooks.Open(strFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet ThisSheet = (Excel.Worksheet)ThisWorkBook.Sheets[1];<br />     ThisSheet.Cells[7,1] = dtEnd.ToShortDateString();<br />     progressBar.Value = 30;<br />     ThisApplication.Visible = false;<br />     DataRow dr = dt.Rows[0];<br />     for( int i=0; i     {<br />      ThisSheet.Cells[7,i+2] = dr[i].ToString();<br />      progressBar.Value +=1;<br />     }<br />     //更新数据后另存为新文件<br />     ThisSheet.SaveAs(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing);<br />    }<br />    catch{}<br />    finally<br />    {<br />     ThisApplication.Quit();<br />     ThisWorkBook = null;<br />     ThisApplication = null;<br />     //dt = null;<br />    }<br />    try<br />    { //打开刚才生成的Excel文件<br />     Excel.Workbook NewWorkBook;<br />     NewWorkBook = NewApplication.Workbooks.Open(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet NewSheet = (Excel.Worksheet)NewWorkBook.Sheets[1];<br />     NewApplication.Visible = true;</span></p>
<p>//也可以使用System.Diagnostics.Process.Start(strSaveFileName);来打开新文件</p>
<p>    }</p>
<p>打开Excel后进程内会多出一个excel进程<br />需要手工清理<br />参考这片文章</p>
<p><a href="http://www.eggheadcafe.com/articles/20021012.asp">http://www.eggheadcafe.com/articles/20021012.asp</a></p>
<p><a href="http://www.github.com/476/archive.aspx">http://www.github.com/476/archive.aspx</a></p>
<p></p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">27 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/04/27/filldatatoexceltemplate/" class="post-title">打开一个Excel模板文件填充数据另存为一个文件</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-它山之石" href='/tags/%E5%AE%83%E5%B1%B1%E4%B9%8B%E7%9F%B3'>它山之石</a>
                                
                                    <a class="post-category post-category-Excel" href='/tags/excel'>Excel</a>
                                
                                    <a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>最近做的东西要求打开一个Excel文件模板后填充数据<br />开始用OleDb连接该Excel文件更新老是出错误 “需要一个可更新的.....“<br /><a href="http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403">http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403</a><br />如果是access这个错误多半是权限引起的 可是我做的是winform 权限是admin啊<br />未果<br />后来用ODBC测试了几个字段 都成功了<br />开始写程序 后发现就有那么2个单元格不听话 提示参数错误<br />郁闷<br /><a href="http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262">http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262</a><br />仍未果<br />没办法翻google<br />获得<br /><a href="http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp">http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp</a><br />用com组件，可行哦，今早上csdn就有网友pm我问是如何搞定的<br />那就写到这里，<br />以下是部分代码，使用前要先按上文中的说明添加Com引用<br />...........<br /><span style="background-color: #d3d3d3;">string strFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Ctemplate%5Ctemplate.tpl"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\template\template.tpl</span></a><span style="background-color: #d3d3d3;">";<br />    string strSaveFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Cexcel%5C%22+System.DateTime.Now.ToString().Replace(%22:%22,%22%22).Replace(%22-%22,%22%22).Replace"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\excel\"+System.DateTime.Now.ToString().Replace(":","").Replace("-","").Replace</span></a><span style="background-color: #d3d3d3;">(" ","")+@".xls";<br />    Excel.Application ThisApplication = new Excel.ApplicationClass();<br />    Excel.Workbook ThisWorkBook;<br />    object missing = System.Reflection.Missing.Value;<br />    try<br />    { <br />     //加载Excel模板文件<br />     ThisWorkBook = ThisApplication.Workbooks.Open(strFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet ThisSheet = (Excel.Worksheet)ThisWorkBook.Sheets[1];<br />     ThisSheet.Cells[7,1] = dtEnd.ToShortDateString();<br />     progressBar.Value = 30;<br />     ThisApplication.Visible = false;<br />     DataRow dr = dt.Rows[0];<br />     for( int i=0; i     {<br />      ThisSheet.Cells[7,i+2] = dr[i].ToString();<br />      progressBar.Value +=1;<br />     }<br />     //更新数据后另存为新文件<br />     ThisSheet.SaveAs(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing);<br />    }<br />    catch{}<br />    finally<br />    {<br />     ThisApplication.Quit();<br />     ThisWorkBook = null;<br />     ThisApplication = null;<br />     //dt = null;<br />    }<br />    try<br />    { //打开刚才生成的Excel文件<br />     Excel.Workbook NewWorkBook;<br />     NewWorkBook = NewApplication.Workbooks.Open(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet NewSheet = (Excel.Worksheet)NewWorkBook.Sheets[1];<br />     NewApplication.Visible = true;</span></p>
<p>//也可以使用System.Diagnostics.Process.Start(strSaveFileName);来打开新文件</p>
<p>    }</p>
<p>打开Excel后进程内会多出一个excel进程<br />需要手工清理<br />参考这片文章</p>
<p><a href="http://www.eggheadcafe.com/articles/20021012.asp">http://www.eggheadcafe.com/articles/20021012.asp</a></p>
<p><a href="http://www.github.com/476/archive.aspx">http://www.github.com/476/archive.aspx</a></p>
<p></p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">26 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/04/26/cb-7697/" class="post-title">关于 “编译器失败，错误代码为 128”</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Debug" href='/tags/debug'>Debug</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p></p>
<p>csdn上有位兄弟遇到这个错误了<br /><a href="http://expert.csdn.net/Expert/topic/3009/3009791.xml?temp=2.024478E-02">http://expert.csdn.net/Expert/topic/3009/3009791.xml?temp=2.024478E-02</a><br />我先是搜索baidu发现一个帖子<br /><a href="http://www.devmanclub.com/showpost.aspx?PostID=1791">http://www.devmanclub.com/showpost.aspx?PostID=1791</a><br />没有解决办法<br />翻google从gotdotnet翻出<a href="http://www.gotdotnet.com/Community/MessageBoard/Thread.aspx?id=209899&amp;Page=1#209899"><strike>一贴</strike> </a>作者称其为“horrible dream”的错误，并给出解决方案<br /><br /><font style="BACKGROUND-COLOR: #a9a9a9">First of all, update your antivirus software and make a full scan on your computer. I guess the cause of the problem is that some hacker has entered in my computer and made some change in my account and security settings, so the sensitive asp.net found it and then stopped working. <br /><br />After u are sure no viruse is in your computer, u can follow the steps below. <br /><br />1. run "aspnet_regiis -ua" in the cmd. u can start the cmd from the vs.net tools in the start menu, otherwise u need type the full path. <br /><br />2. remove the aspnet account from your computer <br /><br />3. uninstall iis <br /><br />4. restart your computer <br /><br />5. reinstall iis <br /><br />6. run "aspnet_regiss -i" in the cmd <br /><br />7. add vs_developers group to iis operators (u can operation in iis) <br /><br />8. open the file "machine.config" which is in "C:\WINNT\Microsoft.NET\Framework\v1.1.xxxx\CONFIG", then find and replace <br />userName="machine" <br />with <br />userName="SYSTEM" <br /><br />9. restart your computer and pray silently <br /><br /><font style="BACKGROUND-COLOR: #ffffff">地址 </font><a href="http://www.gotdotnet.com/Community/MessageBoard/Thread.aspx?id=209899&amp;Page=1#209899"><font style="BACKGROUND-COLOR: #ffffff">http://www.gotdotnet.com/Community/MessageBoard/Thread.aspx?id=209899&amp;Page=1#209899</font></a><br /><font style="BACKGROUND-COLOR: #ffffff">记在这里，免今后自己和其他朋友遇到<br /><br />---------------------------------------------------------------------------------------------------------<br /><br />2004-7-1补记<br /><br /><font style="BACKGROUND-COLOR: #d3d3d3">我们一个客户机器也出了这个问题<br />咨询了微软动力营专家，专家提出2点：<br />//＝＝＝＝＝以下内容来字微软动力营＝＝＝＝＝＝＝<br />您好！<br />    谢谢您使用微软动力营！<br />    对于你的这个问题，通常都是由于以下两个原因引起的，你可以去查看一下：<br />1. 你的客户的机器可能感染了这个病毒</font><a href="http://de.mcafee.com/root/genericVIL.asp?genericURL=/VirusInfo/VIL/dispVirus.asp&amp;virus_k=100252"><font style="BACKGROUND-COLOR: #d3d3d3">http://de.mcafee.com/root/genericVIL.asp?genericURL=/VirusInfo/VIL/dispVirus.asp&amp;virus_k=100252</font></a><br /></font></font><font style="BACKGROUND-COLOR: #d3d3d3">2. 你的客户的服务器运行着一些防病毒软件(象norton)，这有可能导致了这个错误。</font></p>
<br /><p><font style="BACKGROUND-COLOR: #d3d3d3">对于第一个可能，我提供的那篇网页里面提供了清除方法。对于第二个可能你可以将防病毒软件关闭掉试试。</font></p>
<br /><p><font style="BACKGROUND-COLOR: #d3d3d3">希望对你有帮助</font></p>
<br /><p><font style="BACKGROUND-COLOR: #d3d3d3">谭映辉 [微软]  <br />微软全球技术中心 微软动力营合作伙伴技术支持</font></p>
<br /><p><font style="BACKGROUND-COLOR: #a9a9a9"><font style="BACKGROUND-COLOR: #ffffff"><font style="BACKGROUND-COLOR: #d3d3d3">使您100%满意是"微软动力营"合作伙伴支持服务的唯一目标。我们真诚希望您能够对"微软动力营"服务提出宝贵建议和意见，我们将针对您的反馈不断改进服务质量。如有任何问题，请发信至：<br /></font><a href="mailto:cmsdn@microsoft.com"><font style="BACKGROUND-COLOR: #d3d3d3">cmsdn@microsoft.com</font></a><br /><font style="BACKGROUND-COLOR: #d3d3d3">本贴子以“现状”提供且没有任何担保，同时也没有授予任何权利。</font><br />//＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝<br /></font><br /></font></p>                

                    </div>
                </section>
                
                <h1 class="content-subhead">06 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.github.com/blog/2004/04/06/refreshorreloadparentwindowwithoutconfirm/" class="post-title">弹出窗口刷新它的父页面后。出现不重新发送信息，则无法刷新网页</a>

                        <p class="post-meta">
                            
                            
                                
                                    <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                                
                                    <a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                                
                                    <a class="post-category post-category-奇技淫巧" href='/tags/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7'>奇技淫巧</a>
                                
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>做的东西弹出一个窗口处理某些动作后刷新父窗口<br />用<br />window.opener.location.reload();<br />刷新<br />如果父窗口在此之前如果有过提交数据的动作，则会出现这么个讨厌的对话筐<br />“不重新发送信息，则无法刷新网页”<br />痛苦......<br />CSDN搜索未果(有几贴都是用Response.Redirect的方法，但我这里是刷父窗口)。<br />痛苦.<br />........<br />翻我的<a href="http://www.github.com/private/showthread.asp?threadid=148"><strike>小本本</strike></a> 后找到办法<br />用<br />window.opener.location.href=window.opener.location.href<br />去刷新（其实是重定位了一下）父窗口<br />可行。<br />总结： <font style="BACKGROUND-COLOR: #ee82ee">不能一棵树上掉死</font> :P</p>              

                    </div>
                </section>
                
            </div>
            
<div class="pagination">
  <nav role="pagination" class="post-list-pagination">
      
      <a href="/tags/asp.net/page/15/" class="post-list-pagination-item pure-button post-list-pagination-item-prev">
        <i class="fa fa-angle-double-left"></i>&nbsp;Newer
      </a>
      
    <span class="post-list-pagination-item post-list-pagination-item-current">Page 16 of 19</span>
    
      <a href="/tags/asp.net/page/17/" class="post-list-pagination-item pure-button post-list-pagination-item-next">
        Older&nbsp;<i class="fa fa-angle-double-right"></i>
      </a>
    
  </nav>
</div>


            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="https://gohugo.io/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src='https://huobazi.github.com/js/all.min.js'></script>

        </div>
    </div>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-56321-3', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
