
    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">

    <link rel="stylesheet" href='https://huobazi.aspxboy.com/css/all.min.css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="武眉博" href='https://huobazi.aspxboy.com/index.xml' />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="https://huobazi.aspxboy.com">武眉博</a></h1>
            <h2 class="brand-tagline"> Marble&#39;s blog </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="https://twitter.com/huobazi">
                        <i class="fa fa-twitter"></i> Twitter
                    </a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/huobazi">
                        <i class="fa fa-github-alt"></i> Github
                    </a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://www.linkedin.com/in/huobazi">
                        <i class="fa fa-linkedin"></i> LinkedIn
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href='https://huobazi.aspxboy.com/index.xml'>
                        <i class="fa fa-rss"></i> rss
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">07 Jun 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/06/07/cb-13934/" class="post-title">C-omega语言什么东东？</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>谁研究过？<br />和DotNet什么关系？<br />好像是C#的扩展<a href="http://research.microsoft.com/Comega/"><br />http://research.microsoft.com/Comega/</a></p>             

                    </div>
                </section>
                
                <h1 class="content-subhead">03 Jun 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/06/03/cb-13068/" class="post-title">C# VB XML 源代码转Html高亮显示工具</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a><a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><span class="bold"><span class="smalltxt"><strong>C# VB XML 源代码转Html高亮显示工具<br /><br /></strong></span></span><a href="http://www.squishyweb.com/ware/products.asp?q=squishysyntax" target="_blank"><font color="#003366">http://www.squishyweb.com/ware/products.asp?q=squishysyntax</font></a><br />很不错的东西<br />演示:<br /><a href="http://www.squishyweb.com/ware/files/SampleCs-Output.html">http://www.squishyweb.com/ware/files/SampleCs-Output.html</a><br /><a href="http://www.squishyweb.com/ware/files/SampleVb-Output.html">http://www.squishyweb.com/ware/files/SampleVb-Output.html</a><br /><a href="http://www.squishyweb.com/ware/files/SampleXML-Output.html">http://www.squishyweb.com/ware/files/SampleXML-Output.html</a><br />我试了试，真不错！</p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">01 Jun 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/06/01/cb-12759/" class="post-title">一个很全的教程站</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a><a class="post-category post-category-前端开发" href='/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91'>前端开发</a><a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a><a class="post-category post-category-推荐阅读" href='/tags/%E6%8E%A8%E8%8D%90%E9%98%85%E8%AF%BB'>推荐阅读</a><a class="post-category post-category-它山之石" href='/tags/%E5%AE%83%E5%B1%B1%E4%B9%8B%E7%9F%B3'>它山之石</a><a class="post-category post-category-Javascript" href='/tags/javascript'>Javascript</a><a class="post-category post-category-HTML" href='/tags/html'>HTML</a><a class="post-category post-category-CSS" href='/tags/css'>CSS</a><a class="post-category post-category-PHP" href='/tags/php'>PHP</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>很少见教程大全，不知道我是不是很落伍，今天才逛到这里<br /><a href="http://www.w3schools.com/" target="_blank"><br /><img style="border: 0px;" src="/images/hbz_images/66c040d5-df17-43e3-ae0a-3afee8c63b96.jpg" border="0" alt=""></a></p>
<p><strong>HTML Tutorials</strong><br /><a class="left" href="http://www.w3schools.com/html/default.asp" target="_top">Learn HTML</a><br /><a class="left" href="http://www.w3schools.com/xhtml/default.asp" target="_top">Learn XHTML</a><br /><a class="left" href="http://www.w3schools.com/css/default.asp" target="_top">Learn CSS</a><br /><a class="left" href="http://www.w3schools.com/tcpip/default.asp" target="_top">Learn TCP/IP</a></p>
<p><strong>XML Tutorials</strong><br /><a class="left" href="http://www.w3schools.com/xml/default.asp" target="_top">Learn XML</a><br /><a class="left" href="http://www.w3schools.com/xsl/xsl_languages.asp" target="_top">Learn XSL</a><br /><a class="left" href="http://www.w3schools.com/xsl/default.asp" target="_top">Learn XSLT</a><br /><a class="left" href="http://www.w3schools.com/xslfo/default.asp" target="_top">Learn XSL-FO</a><br /><a class="left" href="http://www.w3schools.com/xpath/default.asp" target="_top">Learn XPath</a><br /><a class="left" href="http://www.w3schools.com/xquery/default.asp" target="_top">Learn XQuery</a><br /><a class="left" href="http://www.w3schools.com/dtd/default.asp" target="_top">Learn DTD</a><br /><a class="left" href="http://www.w3schools.com/schema/default.asp" target="_top">Learn Schema</a><br /><a class="left" href="http://www.w3schools.com/dom/default.asp" target="_top">Learn DOM</a><br /><a class="left" href="http://www.w3schools.com/xforms/default.asp" target="_top">Learn XForms</a><br /><a class="left" href="http://www.w3schools.com/soap/default.asp" target="_top">Learn SOAP</a><br /><a class="left" href="http://www.w3schools.com/wsdl/default.asp" target="_top">Learn WSDL</a><br /><a class="left" href="http://www.w3schools.com/rdf/default.asp" target="_top">Learn RDF</a><br /><a class="left" href="http://www.w3schools.com/wap/default.asp" target="_top">Learn WAP</a></p>
<p><strong>Browser Scripting</strong><br /><a class="left" href="http://www.w3schools.com/js/default.asp" target="_top">Learn JavaScript</a><br /><a class="left" href="http://www.w3schools.com/dhtml/default.asp" target="_top">Learn DHTML</a><br /><a class="left" href="http://www.w3schools.com/vbscript/default.asp" target="_top">Learn VBScript</a><br /><a class="left" href="http://www.w3schools.com/wmlscript/default.asp" target="_top">Learn WMLScript</a></p>
<p><strong>Server Scripting</strong><br /><a class="left" href="http://www.w3schools.com/sql/default.asp" target="_top">Learn SQL</a><br /><a class="left" href="http://www.w3schools.com/asp/default.asp" target="_top">Learn ASP</a><br /><a class="left" href="http://www.w3schools.com/ado/default.asp" target="_top">Learn ADO</a><br /><a class="left" href="http://www.w3schools.com/php/default.asp" target="_top">Learn PHP</a></p>
<p><strong>.NET (dotnet)</strong><br /><a class="left" href="http://www.w3schools.com/ngws/default.asp" target="_top">.NET Microsoft</a><br /><a class="left" href="http://www.w3schools.com/aspnet/default.asp" target="_top">.NET ASP</a><br /><a class="left" href="http://www.w3schools.com/dotnetmobile/default.asp" target="_top">.NET Mobile</a></p>
<p><strong>Multimedia</strong><br /><a class="left" href="http://www.w3schools.com/media/default.asp" target="_top">Learn Media</a><br /><a class="left" href="http://www.w3schools.com/smil/default.asp" target="_top">Learn SMIL</a><br /><a class="left" href="http://www.w3schools.com/svg/default.asp" target="_top">Learn SVG</a><br /><a class="left" href="http://www.w3schools.com/flash/default.asp" target="_top">Learn Flash</a></p>
<p><strong>Web Building</strong><br /><a class="left" href="http://www.w3schools.com/site/default.asp" target="_top">Web Building</a><br /><a class="left" href="http://www.w3schools.com/w3c/default.asp" target="_top">Web W3C</a><br /><a class="left" href="http://www.w3schools.com/browsers/default.asp" target="_top">Web Browsers</a><br /><a class="left" href="http://www.w3schools.com/quality/default.asp" target="_top">Web Quality</a><br /><a class="left" href="http://www.w3schools.com/graphics/default.asp" target="_top">Web Graphics</a><br /><a class="left" href="http://www.w3schools.com/careers/default.asp" target="_top">Web Careers</a><br /><a class="left" href="http://www.w3schools.com/hosting/default.asp" target="_top">Web Hosting</a><br /><a class="left" href="http://www.w3schools.com/cert/default.asp" target="_top">Web Certification</a></p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">29 May 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/05/29/cb-12201/" class="post-title">也有人和我一样抱怨为何C#中操作office产品的方法有那么多的参数</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a><a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>原来做过一个小的<a href="http://www.cnblogs.com/huobazi/archive/2004/04/27/7771.aspx">win程序操作Excel的</a> 被那些个参数搞的头晕晕的<br />那么多Missing啊<br />今天在Blog.Msdn.com看到关于VB和C#在office开发中的比较的讨论</p>
<br /><p><a href="http://blogs.msdn.com/cyrusn/archive/2004/05/28/144148.aspx">http://blogs.msdn.com/cyrusn/archive/2004/05/28/144148.aspx</a></p>
<br /><p>嘿嘿，也有人和我一样抱怨为何C#中操作office产品的方法有那么多的参数,其中Word.Documents.Open多达30个参数...</p>
<br /><p><a href="http://blogs.msdn.com/cyrusn/archive/2004/05/28/144165.aspx">http://blogs.msdn.com/cyrusn/archive/2004/05/28/144165.aspx</a><br /><br />继续关注这2篇blog中......</p>                

                    </div>
                </section>
                
                <h1 class="content-subhead">18 May 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/05/18/cb-10058/" class="post-title">为小巨人记一笔，等待明日新星的升起</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-闲言碎语" href='/tags/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD'>闲言碎语</a><a class="post-category post-category-篮球" href='/tags/%E7%AF%AE%E7%90%83'>篮球</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>你知道9岁零6个月时的姚明有多高？告诉你，1米79，吓人吧。而长沙有个比姚明更吓人的小巨人，9岁零6个月的刘武帅，身高1米82，比当年的姚明还高3厘米。现在姚明的身高2米26，而经过科学预测，成年后的刘武帅身高也很可能会超过姚明。</p>
<p>　　刘武帅，今年3月刚满10岁，在湖南省青少年篮球俱乐部接受正规篮球训练不到一年，如今身高已达到1米86。刘武帅的父亲身高1米93，母亲身高1米73，严格的医学检查表明 ，刘武帅身体发育一切正常，出众的身高完全得益于遗传。“他现在穿49码的鞋，身高平均每年要长7厘米。我们现在最发愁的是给他买不到合适的鞋。”刘武帅的妈妈伍女士说。</p>
<p>　　5月10日下午，记者在育英小学篮球馆看到了这位高大的“篮球小子”：结实的身材，留着和姚明一样的寸头，有着和姚明一样的深眼眶和大眼睛。</p>
<p>　　省青少年篮球俱乐部总教练毛地对刘武帅关爱有加，一心想把他培养成和姚明一样的优秀中锋，不过由于精力有限，毛指导非常希望刘武帅能早日接受更专业化的篮球训练。毛指导告诉记者，广东、北京、上海等多家篮球职业俱乐部闻讯湖南有这样出众的小巨人后，将先后于近期来长“选秀”。</p>
<p>　　“他刚来的时候，我看到他不仅有身高，而且协调性、灵活性各方面都很出色，我感觉这是个难得的好苗子。”毛指导说。</p>
<p>　　刘武帅现在的表现，也证实了毛指导的眼光，也让他的父母坚定了把孩子培养成材的决心。“武帅也挺喜欢篮球的，一开始我们想让他念书，将来走CUBA的道路，但后来我们又觉得，这么好的条件，不练篮球，真的可惜了。现在我们只让他在学校上语文、数学和英语课，其他课程家里可以给他辅导，而课余的时间都让他参加训练，他进步也挺快的。”谈到心爱的儿子，伍女士的欣喜之情溢于言表。</p>
<p>　　训练结束后，毛指导带着刘武帅配合记者拍照。小武帅有些腼腆，毛指导在一旁鼓励道：“就像姚明那样，对，就这样，眼睛再看得高一点……”</p>
<p>　　(稿源：三湘都市报)<img style="border: 0px;" src="/images/hbz_images/c6c7de29-4663-4b46-bdb7-819e34f74161.jpg" border="0" alt=""><br /><span style="background-color: #7fffd4;">在我的博客上为小巨人记一笔，等待明日新星的升起<br /></span></p>                

                    </div>
                </section>
                
                <h1 class="content-subhead">11 May 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/05/11/cb-8865/" class="post-title">TechNet月度光盘资料&#43;贺卡&#43;msn贴纸&#43;TechNet体恤 被哄抢而光</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a><a class="post-category post-category-.Net其他" href='/tags/.net%E5%85%B6%E4%BB%96'>.Net其他</a><a class="post-category post-category-TechNet" href='/tags/technet'>TechNet</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>前阵子换了工作，没有及时的更新TechNet的资料4月份的光盘资料被寄到原来单位去了<br />连同一张贺卡，msn贴纸，TechNet的体恤 昨天同事带给了我。<br />好消息和MM共享之... ...</p>
<p>随之贺卡和msn贴纸全部被没收（单人哄抢），XL号的体恤我竟然穿上象紧身装(PS:俺190多斤重的)，也被剥夺，MM曰：这体恤我晚上穿出去乘凉，宽宽松松的，刚好。</p>
<p>55555......</p>
<p>一堆东西只剩下张光盘是我的了。<br />MM的话“微软是关心你们这些开发人员，不想让你们打光棍，这些卡啊贴纸啊的就是让你送女朋友的！”<br />惊人之语啊～～<br />当然MM也不忘抚慰一下我，把贴纸里那只美丽的MSN蝴蝶贴在我的手机上，剩下的MSN小人一个也不许我要了</p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">07 May 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/05/07/cb-8466/" class="post-title">一个好地方～SharpLibrary</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a><a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><a href="http://24.199.8.122/" target="_blank"><img src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg49" border="0"></a></p>              

                    </div>
                </section>
                
                <h1 class="content-subhead">30 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/30/cb-8176/" class="post-title">一个关于DataGrid的打印类,分享,感谢作者</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a><a class="post-category post-category-.Net其他" href='/tags/.net%E5%85%B6%E4%BB%96'>.Net其他</a><a class="post-category post-category-Print" href='/tags/print'>Print</a><a class="post-category post-category-DataGrid" href='/tags/datagrid'>DataGrid</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p><p><font size="2">手中的活计需要打印,就到处找找。<br />从</font><a href="http://www.google.com/"><font size="2">google</font></a><font size="2">中扑获,挺不错的，大家共享～<br />how can i print the data in DataGrid?</font><a href="http://forums.aspfree.com/archive/t-17107"><br /><font size="2"><a href="http://forums.aspfree.com/archive/t-17107">http://forums.aspfree.com/archive/t-17107</a></font></a><br /><a href="http://forums.aspfree.com/t17107/s.html"><font size="2"><a href="http://forums.aspfree.com/t17107/s.html">http://forums.aspfree.com/t17107/s.html</a></font></a><br /></p>
<pre>using System;
using System.Collections;
using System.ComponentModel;
using System.Drawing;
using System.Drawing.Printing;
using System.Data;</p>

<p>using System.Windows.Forms;</p>

<p>namespace Hooooo.Print
{
public class DataGridPrinter
{
private DataGrid dataGrid;
private PrintDocument printDocument;
private PageSetupDialog pageSetupDialog;
private PrintPreviewDialog printPreviewDialog;</p>

<p>public DataGridPrinter(DataGrid dataGrid)
{
this.dataGrid = dataGrid;
printDocument = new PrintDocument();
printDocument.PrintPage += new PrintPageEventHandler(this.printDocument_PrintPage);
}</p>

<p>private void printDocument_PrintPage(object sender, System.Drawing.Printing.PrintPageEventArgs e)
{
int rowCount = 0;
int colCount = 0;
int x = 0;
int y = 0;
int rowGap = 20;
int colGap = 5;
int leftMargin = 50;
Font font = new Font(&ldquo;Arial&rdquo;, 10);
Font headingFont = new Font(&ldquo;Arial&rdquo;, 11, FontStyle.Underline);
Font captionFont = new Font(&ldquo;Arial&rdquo;, 10, FontStyle.Bold);
Brush brush = new SolidBrush(Color.Black);
string cellValue = &ldquo;&rdquo;;</p>

<p>if(dataGrid.DataSource.GetType().ToString() == &ldquo;System.Data.DataTable&rdquo;)
{
rowCount = ((DataTable)dataGrid.DataSource).Rows.Count;
}
else if(dataGrid.DataSource.GetType().ToString() == &ldquo;System.Collections.ArrayList&rdquo;)
{
rowCount = ((ArrayList)dataGrid.DataSource).Count;
}
colCount = dataGrid.TableStyles[0].GridColumnStyles.Count;</p>

<p>//print caption
if(dataGrid.CaptionVisible)
{
y += rowGap;
x = leftMargin;
e.Graphics.DrawString(dataGrid.CaptionText, captionFont, brush, x, y);
}</p>

<p>//print headings
y += rowGap;
x = leftMargin;
for(int j = 0; j &lt; colCount; j++)
{
if(dataGrid.TableStyles[0].GridColumnStyles[j].Width &gt; 0)
{
cellValue = dataGrid.TableStyles[0].GridColumnStyles[j].HeaderText;
e.Graphics.DrawString(cellValue, headingFont, brush, x, y);
x += dataGrid.TableStyles[0].GridColumnStyles[j].Width + colGap;
}
}</p>

<p>//print all rows
for(int i = 0; i &lt; rowCount; i++)
{
y += rowGap;
x = leftMargin;
for(int j = 0; j &lt; colCount; j++)
{
if(dataGrid.TableStyles[0].GridColumnStyles[j].Width &gt; 0)
{
cellValue = dataGrid[i,j].ToString();
e.Graphics.DrawString(cellValue, font, brush, x, y);
x += dataGrid.TableStyles[0].GridColumnStyles[j].Width + colGap;
y = y + rowGap * (cellValue.Split(new char[] {&rsquo;\r&rsquo;, &lsquo;\n&rsquo;}).Length - 1);
}
}
}
string s = cellValue;
string f3 = cellValue;
}</p>

<p>public PrintDocument GetPrintDocument()
{
return printDocument;
}</p>

<p>public void Print()
{
try
{
pageSetupDialog = new PageSetupDialog();
pageSetupDialog.Document = printDocument;
pageSetupDialog.ShowDialog();
printPreviewDialog = new PrintPreviewDialog();
printPreviewDialog.Document = printDocument;
printPreviewDialog.Height = 600;
printPreviewDialog.Width = 800;
printPreviewDialog.ShowDialog();
}
catch(Exception e)
{
throw new Exception(&ldquo;Printer error.&rdquo; + e.Message);
}</p>

<p>}
}
}
</pre>
<p><br />需要打印表格线条及分页的朋友，可以看一下下面这篇文章：<br /> <br /></p>
<div><strong><font face="Verdana" size="4"><a title="How to Print a DataGrid in C# and .NET" style="COLOR: #0000ff" href="http://www.c-sharpcorner.com/Graphics/DataGridPrinterMG.asp" target="_blank"><strong><font face="Verdana" size="4">How to Print a DataGrid in C# and .NET</font> </strong></a><br /><br /></font><br /><div></div>
<div>
<img style="WIDTH: 672px; HEIGHT: 352px" height="245" src="/images/hbz_images/e01387bd-8f4f-4638-8131-226ce244e723.jpg50" width="510"> </div>
<div> </div>
<div></div>
<p></p></strong></div></p>

                    </div>
                </section>
                
                <h1 class="content-subhead">30 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/30/confirmbutton/" class="post-title">可以弹出确认对话框的自定义Web服务器控件ConfirmButton</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a><a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a><a class="post-category post-category-自定义控件" href='/tags/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6'>自定义控件</a><a class="post-category post-category-ConfirmButton" href='/tags/confirmbutton'>ConfirmButton</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">经常在论坛里看到类似这样的问题：“</span><span lang="EN-US">…</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如何在点击删除按钮的时候弹出个确认删除对话框”。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">下面我们来自己写一个这样的自定义</span><span lang="EN-US">Web</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">服务器控件</span><span lang="EN-US">!</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">思路如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">继承</span><span lang="EN-US">System.Web.UI.WebControls.Button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">控件</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">增加一个属性“</span><span lang="EN-US">ConfirmMessage</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”来表示弹出确认框上面的提示信息。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在服务器控件呈现在页面之前把一段</span><span lang="EN-US">javascript</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">写到页面</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">内容如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;script language="JavaScript"&gt;<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;!--<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">function _doAspxBoyConfirm()<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy">return confirm("</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">你确认删除</span><span lang="EN-US" style="COLOR: navy">/</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">保存吗</span><span lang="EN-US" style="COLOR: navy">??")<p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">//--&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">&lt;/script&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">查一下</span><span lang="EN-US">msdn</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中对于</span><b><span lang="EN-US" style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto">Control.OnPreRender</span></b><span lang="EN-US"> </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">方法<span class="ilang">的描述</span></span><b><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可以得到“<b><span style="COLOR: navy">此方法通知服务器控件在保存视图状态和呈现内容之前，执行任何必要的预呈现步骤</span></b></span><span lang="EN-US">”.</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">所以我们只要在</span><b><span lang="EN-US" style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto">OnPreRender</span></b><b><span style="BACKGROUND: #d9d9d9; COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-shading: white; mso-pattern: gray-15 auto">方法内</span><span style="BACKGROUND: #d9d9d9; COLOR: navy; mso-shading: white; mso-pattern: gray-15 auto"> </span></b><b><span style="BACKGROUND: #d9d9d9; COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-shading: white; mso-pattern: gray-15 auto">用</span></b><span lang="EN-US">Page.RegisterClientScriptBlock</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">把这段</span><span lang="EN-US">javascript</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">发送到客户端，并且给</span><span lang="EN-US">Button. Attributes</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">属性内添加一个“</span><span lang="EN-US">onclick</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”的客户端属性对应值为</span><span lang="EN-US">: "return _doAspxBoyConfirm()”.</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">详细情况可以查阅</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font size="3">ms-help://MS.VSCC.2003/MS.MSDNQTR.2003FEB.2052/cpref/html/frlrfsystemwebuiwebcontrolswebcontrolclassattributestopic.htm</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这样一个具有</span><span lang="EN-US">ConFirm</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">功能的</span><span lang="EN-US">Button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">就基本上建立起来了。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">新建一个测试该控件的工程</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在工具箱上点右键选择“添加</span><span lang="EN-US">/</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">移除项”，点击浏览选择编译好的</span><span lang="EN-US">dll</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">文件，点击确定，你会发现</span><span lang="EN-US">ConFirmButton</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">已经添加到工具箱内了</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">将其托到一个</span><span lang="EN-US">Aspx</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">页面内</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在属性设置内给</span><span lang="EN-US">ConfirmMessage</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">值为你要的弹出框内容比如“确定删除吗</span><span lang="EN-US">?</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”，按</span><span lang="EN-US">F5</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">运行。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当点该按钮时会弹出一个</span><span lang="EN-US">confirm</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">对话框询问“确定删除吗</span><span lang="EN-US">?</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">”</span><span lang="EN-US">,</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果点击确定则执行</span><span lang="EN-US">button</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的</span><span lang="EN-US">Button_Click</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">事件，如果点击取消则不执行。</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">你可以查看他生成的</span><span lang="EN-US">html</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">代码，以加深对该控件工作原理的理解</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font size="3">完整的代码如下：</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Web.UI;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Web.UI.WebControls;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.ComponentModel;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">using System.Text;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">namespace AspxBoy.Com.ConfirmButton<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>/// &lt;summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy"><span style="mso-tab-count: 1">       </span>/// Button</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">点击时会弹出一个对话框要求确认</span><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>/// &lt;/summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>public class ConfirmButton : System.Web.UI.WebControls.Button<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span><span style="mso-tab-count: 1">       </span>private string _confirmMessage;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>/// &lt;summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><b><span lang="EN-US" style="COLOR: navy"><span style="mso-tab-count: 2">              </span>/// </span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当客户端点击此</span><span lang="EN-US" style="COLOR: navy">Button</span></b><b><span style="COLOR: navy; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">时弹出的提示消息筐的内容</span><span lang="EN-US" style="COLOR: navy"><p></p></span></b></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>/// &lt;/summary&gt;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public string ConfirmMessage<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>get<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span><span style="mso-tab-count: 1">       </span>return _confirmMessage;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>set<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span><span style="mso-tab-count: 1">       </span>_confirmMessage = value;<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 3">                     </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"> <p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span><span style="mso-tab-count: 1">       </span>protected override void OnPreRender(System.EventArgs e)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>StringBuilder sb = new StringBuilder();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;script language=\"JavaScript\"&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;!--");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("/*--------------------------------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("ControlName:\t\tAspxBoy.Com.ConfirmButton");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("AuthorName:\t\t\tHuobazi,WuMeibo");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("CopyRight:\t\t\twww.AspxBoy.Com");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("---------------------------------------------*/");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("function _doAspxBoyConfirm()");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("{");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("return confirm(\"");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(ConfirmMessage);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("\")");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("}");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append(System.Environment.NewLine);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("//--&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>sb.Append("&lt;/script&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>Page.RegisterClientScriptBlock("_doAspxBoyConfirm",sb.ToString());<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>this.Attributes.Add("onclick","return _doAspxBoyConfirm()");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.OnPreRender(e);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public override void RenderBeginTag(HtmlTextWriter writer)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!-------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("AspxBoy.Com.ConfirmButton Start");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("\tAuthorName: \tHuobazi");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine(" ---------------------&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!-------------------- ");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("Copyright:2004 Huobazi(www.AspxBoy.com)");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write(" ---------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine("&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.RenderBeginTag(writer);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>public override void RenderEndTag(HtmlTextWriter writer)<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>{<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>base.RenderEndTag(writer);<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("&lt;!------------------------------- ");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write("AspxBoy.Com.ConfirmButton<span style="mso-spacerun: yes">  </span>End");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.Write(" --------------------------------");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine("&gt;");<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span><span style="mso-tab-count: 1">       </span>writer.WriteLine();<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 2">              </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3"><span style="mso-tab-count: 1">       </span>}<p></p></font></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b><span lang="EN-US" style="COLOR: navy"><font size="3">}<p></p></font></span></b></p>
<p><br /></p>               

                    </div>
                </section>
                
                <h1 class="content-subhead">27 Apr 2004</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://huobazi.aspxboy.com/blog/2004/04/27/filldatatoexceltemplate/" class="post-title">打开一个Excel模板文件填充数据另存为一个文件</a>

                        <p class="post-meta">
                            
                            
                                <a class="post-category post-category-ASP.NET" href='/tags/asp.net'>ASP.NET</a><a class="post-category post-category-Asp.net" href='/tags/asp.net'>Asp.net</a><a class="post-category post-category-它山之石" href='/tags/%E5%AE%83%E5%B1%B1%E4%B9%8B%E7%9F%B3'>它山之石</a><a class="post-category post-category-Excel" href='/tags/excel'>Excel</a><a class="post-category post-category-代码片段" href='/tags/%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5'>代码片段</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        <p>最近做的东西要求打开一个Excel文件模板后填充数据<br />开始用OleDb连接该Excel文件更新老是出错误 “需要一个可更新的.....“<br /><a href="http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403">http://expert.csdn.net/Expert/topic/2992/2992809.xml?temp=.4825403</a><br />如果是access这个错误多半是权限引起的 可是我做的是winform 权限是admin啊<br />未果<br />后来用ODBC测试了几个字段 都成功了<br />开始写程序 后发现就有那么2个单元格不听话 提示参数错误<br />郁闷<br /><a href="http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262">http://expert.csdn.net/Expert/topic/3000/3000113.xml?temp=.3331262</a><br />仍未果<br />没办法翻google<br />获得<br /><a href="http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp">http://www.c-sharpcorner.com/winforms/ExcelReadMG.asp</a><br />用com组件，可行哦，今早上csdn就有网友pm我问是如何搞定的<br />那就写到这里，<br />以下是部分代码，使用前要先按上文中的说明添加Com引用<br />...........<br /><span style="background-color: #d3d3d3;">string strFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Ctemplate%5Ctemplate.tpl"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\template\template.tpl</span></a><span style="background-color: #d3d3d3;">";<br />    string strSaveFileName = </span><a href="mailto:Environment.CurrentDirectory+@%22%5Cexcel%5C%22+System.DateTime.Now.ToString().Replace(%22:%22,%22%22).Replace(%22-%22,%22%22).Replace"><span style="background-color: #d3d3d3;">Environment.CurrentDirectory+@"\excel\"+System.DateTime.Now.ToString().Replace(":","").Replace("-","").Replace</span></a><span style="background-color: #d3d3d3;">(" ","")+@".xls";<br />    Excel.Application ThisApplication = new Excel.ApplicationClass();<br />    Excel.Workbook ThisWorkBook;<br />    object missing = System.Reflection.Missing.Value;<br />    try<br />    { <br />     //加载Excel模板文件<br />     ThisWorkBook = ThisApplication.Workbooks.Open(strFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet ThisSheet = (Excel.Worksheet)ThisWorkBook.Sheets[1];<br />     ThisSheet.Cells[7,1] = dtEnd.ToShortDateString();<br />     progressBar.Value = 30;<br />     ThisApplication.Visible = false;<br />     DataRow dr = dt.Rows[0];<br />     for( int i=0; i     {<br />      ThisSheet.Cells[7,i+2] = dr[i].ToString();<br />      progressBar.Value +=1;<br />     }<br />     //更新数据后另存为新文件<br />     ThisSheet.SaveAs(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing);<br />    }<br />    catch{}<br />    finally<br />    {<br />     ThisApplication.Quit();<br />     ThisWorkBook = null;<br />     ThisApplication = null;<br />     //dt = null;<br />    }<br />    try<br />    { //打开刚才生成的Excel文件<br />     Excel.Workbook NewWorkBook;<br />     NewWorkBook = NewApplication.Workbooks.Open(strSaveFileName,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing,missing);<br />     Excel.Worksheet NewSheet = (Excel.Worksheet)NewWorkBook.Sheets[1];<br />     NewApplication.Visible = true;</span></p>
<p>//也可以使用System.Diagnostics.Process.Start(strSaveFileName);来打开新文件</p>
<p>    }</p>
<p>打开Excel后进程内会多出一个excel进程<br />需要手工清理<br />参考这片文章</p>
<p><a href="http://www.eggheadcafe.com/articles/20021012.asp">http://www.eggheadcafe.com/articles/20021012.asp</a></p>
<p><a href="http://www.aspxboy.com/476/archive.aspx">http://www.aspxboy.com/476/archive.aspx</a></p>
<p></p>             

                    </div>
                </section>
                
            </div>
            
<div class="pagination">
  <nav role="pagination" class="post-list-pagination">
      
      <a href="/page/18/" class="post-list-pagination-item pure-button post-list-pagination-item-prev">
        <i class="fa fa-angle-double-left"></i>&nbsp;Newer
      </a>
      
    <span class="post-list-pagination-item post-list-pagination-item-current">Page 19 of 22</span>
    
      <a href="/page/20/" class="post-list-pagination-item pure-button post-list-pagination-item-next">
        Older&nbsp;<i class="fa fa-angle-double-right"></i>
      </a>
    
  </nav>
</div>


            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="https://gohugo.io/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src='https://huobazi.aspxboy.com/js/all.min.js'></script>

        </div>
    </div>
</div>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-56321-3', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
