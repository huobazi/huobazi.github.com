---
layout: post
title: 数据从SqlServer6.5到SqlServer2000
comments: true
date: 2004-07-14
tags:
- ASP.NET
- SQL Server
---

<p></p>
<p></p>
<div style="FONT-SIZE: 13px">一台SqlServer65上的数据需要导到SqlServer200下<br />源机器:WinNt4 sp6 SqlServer65 Sp5a<br />目的机器: Win2000 sp4 SqlServer2000 sp3a<br />导入的过程非常艰辛,必尽这两个产品版本相距太远了.<br />微软动力营的专家Mingqing Cheng给予了很多帮助,在此表示由衷的感谢!<br />以下摘自微软动力营<br /><textarea style="WIDTH: 558px; HEIGHT: 88px" rows="4" cols="60">活靶子，您好 根据您的描述，我对您问题的理解是您希望将原来SQL Server 6.5 上的数据升级到SQL Server 2000上。不知道我理解的正确吗？ 根据我的经验，在升级之前您需要首先将SQL Server 6.5升级到下列版本 SQL Server 6.5 Post Service Pack 5a Update (Intel) http://www.microsoft.com/downloads/details.aspx?FamilyID=6bf98310-4fea-405f-9ee0-c1e22580776b&amp;DisplayLang=en 然后您准备升级的SQL Server 6.5是否和SQL Server 2000安装在同一台服务器上呢？在升级的过程中您需要从SQL Server 2000的SQL Server Upgrade Wizard来进行升级。 在下面的这篇文档中罗列了三点在升级中可能要考虑的地方，以及可能的影响 How To Upgrade from SQL Server 6.5 http://msdn.microsoft.com/library/default.asp?url=/library/en-us/howtosql/ht_install_48l5.asp 具体的升级要求和标准，您可以参照下列白皮书 How to Upgrade SQL Server 6.5 and 7.0 to SQL Server 2000 http://www.microsoft.com/technet/prodtechnol/sql/2000/deploy/sqlugrd.mspx 最后，您可以从这里找到一些常见的在升级到SQL Server 2000时可能遇到的问题 INF: Frequently Asked Questions - SQL Server 2000 - Upgrade http://support.microsoft.com/default.aspx?scid=kb;en-us;261334 在这篇文章中，我愿意向您重点推荐的针对问题8的回答：对于SQL Server 6.5的大小可能对升级时间带来的影响 希望我回答并且解决了您的问题，而且所附上的这些信息对您有所帮助！如有任何疑问或需要进一步帮助，请您直接在新闻组里发贴，我们非常乐意帮助您解决问题！ 希望您能满意我的支持服务！感谢您选择微软产品并使用微软动力营合作伙伴新闻组技术支持！ Mingqing Cheng [微软] 微软全球技术中心 微软动力营合作伙伴技术支持 ----------------------------------------------- 使您100%满意是"微软动力s营"合作伙伴支持服务的唯一目标。我们真诚希望您能够对"微软动力营"服务提出宝贵建议和意见，我们将针对您的反馈不断改进服务质量。如有任何问题，请发信至：cmsdn@microsoft.com </textarea><br /><br /><textarea style="WIDTH: 558px; HEIGHT: 88px" rows="4" cols="60">您好, 能麻烦您具体和我说一下您采用什么方式升级的吗?在SQL Server Upgrade Wizard选择的时候，您是否选择了Object and Data呢？您升级的时候，最好能够直接升级到SQL Server默认的Instance。您是否已经将SQL Server 6.5和SQL server 2000分别升级到Service Pack 5a和Service Pack 3a呢？ 您在升级的过程中有没有遇到什么错误的信息呢？您对于该过程越详细地描述就能有助于我们越快越准确地找到问题的所在。 下面我将SQL Server Books Online上有关如何从SQL Server 6.5升级到SQL Server 2000的需要注意的事项粘贴在下面 =================================== 从 SQL Server 6.5 升级时的注意事项： 在升级过程中，SQL Server 6.5 服务器将停止并启动，同时将对象编为脚本并析取数据。数据传输开始后，只有 SQL Server 2000 在运行，无法访问 SQL Server 6.5。 如果将现有的 SQL Server 6.5 服务器升级到运行 SQL Server 2000 的另一台计算机，则这两台计算机都应配置为对 MSSQLServer 服务使用域用户名和密码。 在该升级过程中，在 SQL Server 6.5 中使用 sp_addmessage 创建的用户定义消息不转换到 SQL Server 2000。若要保留这些自定义消息，请将在 SQL Server 6.5 中添加的消息手工复制到 SQL Server 2000 安装。 =================================== 下面的这篇联机手册中的文档详细介绍了如何使用SQL Server Upgrade Wizard来升级的步骤 “如何使用直接管道将 SQL Server 6.5 版升级到 SQL Server 2000（SQL Server 升级向导）” 希望您能满意我的支持服务！感谢您选择微软产品并使用微软动力营合作伙伴新闻组技术支持！ Mingqing Cheng [微软] 微软全球技术中心 微软动力营合作伙伴技术支持 ----------------------------------------------- 使您100%满意是"微软动力s营"合作伙伴支持服务的唯一目标。我们真诚希望您能够对"微软动力营"服务提出宝贵建议和意见，我们将针对您的反馈不断改进服务质量。如有任何问题，请发信至：cmsdn@microsoft.com 本贴子以“现状”提供且没有任何担保，同时也没有授予任何权利。</textarea><br /><br /><textarea style="WIDTH: 558px; HEIGHT: 88px" rows="4" cols="60">您好， 不知道您的问题解决了吗？我给您的那些建议是否有用呢？ 您能够成功地从SQL Server 6.5中将数据导入SQL Server 2000，而不是只有表的结构了吗？ 如果您在导入的过程中遇到问题，您可以继续在这个贴字后面提问或者发新的帖子提问。我会很愿意在这方面尽我的所能来帮助您：） 希望您能满意我的支持服务！感谢您选择微软产品并使用微软动力营合作伙伴新闻组技术支持！ Mingqing Cheng [微软] 微软全球技术中心 微软动力营合作伙伴技术支持 ----------------------------------------------- 使您100%满意是"微软动力s营"合作伙伴支持服务的唯一目标。我们真诚希望您能够对"微软动力营"服务提出宝贵建议和意见，我们将针对您的反馈不断改进服务质量。如有任何问题，请发信至：cmsdn@microsoft.com 本贴子以“现状”提供且没有任何担保，同时也没有授予任何权利。 </textarea><br />我们在升级过程中发现很难将SQL65升级通过"一切版本切换"升级过来,期间碰到了很多错误,<br />也不知道是什么原因.这里就不在罗列了.<br />又尝试了好多方法,后来,我们采用如下步骤达到了目的!<br /><br /><div style="FONT-SIZE: 13px; COLOR: blue; BACKGROUND-COLOR: beige">1,在Sql65中选择生成Sql脚本,对于所有的过程,视图,表,用户,等信息生成Sql脚本.<br />该脚本无法在Sql2000下直接运行,我们发现Sql65所生成的脚本中对于字符串均用""括起来的,在文<br />本编辑器中采用批量替换"为'后可以运行.<br />2,在Sql2000下,建立原Sql2000数据库内的所有用户,密码均相同,运行该Sql脚本<br />3,在Sql2000下,对于刚新并运行了Sql脚本的建数据库导入数据,源服务器和数据库选择SQL65<br />下的数据库,导入. 选择所有对象后,再去掉视图,因为我们发现导过来后会把视图也当作一个表处理,<br />但是该视图已经存在,会报错: "已经存在对象..."<br />经过几次尝试数据成功导入,所有的主建,视图,过程等均未丢失.<br /><br />
</div>
<p>以上步是在NT sp6 SqlServer6.5 和Win2000 sp4 SqlServer2000 Sp3a下. <br />再次感谢微软动力营,感谢Mingqing Cheng给我们的帮助! </p>
</div>
<br /><p></p>				
